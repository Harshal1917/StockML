(qlib_env) PS E:\Finance Internship\TASK_5\NSEI> python .\model_raw.py
[17812:MainThread](2025-05-09 16:59:15,103) INFO - qlib.Initialization - [config.py:420] - default_conf: client.
[17812:MainThread](2025-05-09 16:59:15,109) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[17812:MainThread](2025-05-09 16:59:15,110) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': WindowsPath('C:/Users/ASUS/.qlib/qlib_data/NSEI_raw_10yrs')}
Raw data shape: (1895, 5)
Raw data NaN count per column:
$open      0
$high      0
$low       0
$close     0
$volume    0
dtype: int64
                                  $open        $high         $low       $close   $volume
instrument      datetime
^NSEI_RAW_10YRS 2015-04-24  8405.700195  8413.299805  8273.349609  8305.250000  173600.0
                2015-04-27  8330.549805  8334.450195  8202.349609  8213.799805  171500.0
                2015-04-28  8215.549805  8308.000000  8185.149902  8285.599609  174600.0
                2015-04-29  8274.799805  8308.200195  8219.200195  8239.750000  160400.0
                2015-04-30  8224.500000  8229.400391  8144.750000  8181.500000  267700.0

Available instruments: {'market': 'all', 'filter_pipe': []}
Final feature expressions: ['($close - Ref($close, 1)) / Ref($close, 1)', 'Std($close, 5)', '($volume - Ref($volume, 1)) / Ref($volume, 1)']
Feature names: ['returns_(close-Ref(', 'volatility_Std(close,5)', 'volume_change_(volume-Ref(']
[17812:MainThread](2025-05-09 16:59:23,376) INFO - qlib.timer - [log.py:127] - Time cost: 0.163s | Loading data Done
[17812:MainThread](2025-05-09 16:59:23,376) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | fit & process data Done
[17812:MainThread](2025-05-09 16:59:23,376) INFO - qlib.timer - [log.py:127] - Time cost: 0.163s | Init data Done

Dataset information:
Training data shapes:
('feature', 'returns_(close-Ref(') shape: (1895,)
('feature', 'volatility_Std(close,5)') shape: (1895,)
('feature', 'volume_change_(volume-Ref(') shape: (1895,)
('label', 'NEXT_CLOSE') shape: (1895,)

Available columns in the dataset:
MultiIndex([('feature',        'returns_(close-Ref('),
            ('feature',    'volatility_Std(close,5)'),
            ('feature', 'volume_change_(volume-Ref('),
            (  'label',                 'NEXT_CLOSE')],
           )
Train data after processing: (1895, 4)
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

NaN count per column:
feature  returns_(close-Ref(           1
         volatility_Std(close,5)       1
         volume_change_(volume-Ref(    2
label    NEXT_CLOSE                    0
dtype: int64

Rows with all NaN values:
Empty DataFrame
Columns: [(feature, returns_(close-Ref(), (feature, volatility_Std(close,5)), (feature, volume_change_(volume-Ref(), (label, NEXT_CLOSE)]   
Index: []

Rows with at least one non-NaN value:
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

Feature Correlations:
Highly correlated features:

Do you want to proceed with training? (y/n): y
[17812:MainThread](2025-05-09 16:59:26,980) INFO - qlib.workflow - [exp.py:258] - Experiment 208382467731689026 starts running ...
[17812:MainThread](2025-05-09 16:59:27,323) INFO - qlib.workflow - [recorder.py:345] - Recorder 1d0f992e1fd54af4ac4ec9a47bd65d32 starts running under Experiment 208382467731689026 ...

Training model...
Training until validation scores don't improve for 50 rounds
[20]    train's l2: 9.63014e+06 valid's l2: 5.11764e+07
[40]    train's l2: 8.83452e+06 valid's l2: 4.97801e+07
[60]    train's l2: 8.26188e+06 valid's l2: 4.87656e+07
[80]    train's l2: 7.84772e+06 valid's l2: 4.80143e+07
[100]   train's l2: 7.52574e+06 valid's l2: 4.7506e+07
[120]   train's l2: 7.28527e+06 valid's l2: 4.70625e+07
[140]   train's l2: 7.0791e+06  valid's l2: 4.66913e+07
[160]   train's l2: 6.90239e+06 valid's l2: 4.656e+07
[180]   train's l2: 6.77216e+06 valid's l2: 4.62815e+07
[200]   train's l2: 6.64409e+06 valid's l2: 4.60684e+07
[220]   train's l2: 6.55482e+06 valid's l2: 4.59793e+07
[240]   train's l2: 6.4485e+06  valid's l2: 4.58486e+07
[260]   train's l2: 6.37203e+06 valid's l2: 4.57584e+07
[280]   train's l2: 6.29472e+06 valid's l2: 4.56373e+07
[300]   train's l2: 6.22942e+06 valid's l2: 4.56223e+07
[320]   train's l2: 6.17362e+06 valid's l2: 4.56477e+07
[340]   train's l2: 6.12026e+06 valid's l2: 4.55842e+07
[360]   train's l2: 6.0724e+06  valid's l2: 4.55694e+07
[380]   train's l2: 6.02333e+06 valid's l2: 4.56066e+07
Early stopping, best iteration is:
[335]   train's l2: 6.13266e+06 valid's l2: 4.55342e+07

Training Metrics:
train: OrderedDict([('l2', [10699600.158484442, 10633331.2495526, 10569109.950164096, 10505142.432186686, 10442537.269416708, 10381999.05221954, 10322622.558123603, 10264514.125469605, 10207697.089352207, 10150287.085507678, 10093469.10181894, 10037642.217206521, 9983101.056414833, 9929654.339120904, 9877475.826827662, 9826188.735784244, 9775820.902471358, 9726055.11160674, 9677775.632459188, 9630143.446310427, 9585546.775037635, 9541843.529606724, 9497953.608512126, 9455596.94656511, 9414314.511479465, 9370618.164252974, 9327808.734489165, 9285868.40853311, 9244779.729131918, 9204558.38461805, 9164279.929709861, 9125188.682249434, 9086902.922136975, 9048965.46857426, 9012189.103564283, 8975229.154728185, 8938993.479738517, 8903463.673329994, 8868668.440205473, 8834518.761983152, 8801053.943432638, 8768188.807818366, 8736078.48916626, 8704571.710935885, 8673760.716333203, 8642725.312955039, 8612877.18226933, 8583463.38286612, 8554175.617471604, 8526136.515412655, 8497727.172419671, 8469873.591500008, 8442545.063820463, 8416304.702667855, 8389774.56768782, 8363245.695596023, 8337046.119326575, 8311999.097883654, 8286707.452427342, 8261883.310615587, 8237067.34603691, 8212810.378629315, 8189161.341984027, 8165931.685399131, 8143230.511115198, 8121425.667840032, 8100088.083623974, 8079173.830308321, 8058705.6172979465, 8038639.196338175, 8018478.66248476, 7998335.979001325, 7978137.369171016, 7958773.47415949, 7939739.274286641, 7920458.618604857, 7901753.09956528, 7883215.031511822, 7865282.848407742, 7847723.541862798, 7830467.423372642, 7812940.042725233, 7796380.281787239, 7779546.836277843, 7763665.883859372, 7746299.179267759, 7729192.107447326, 7712090.145061841, 7694871.105796582, 7678831.060370659, 7661557.878680661, 7644766.903320994, 7628509.464077427, 7612194.509112312, 7596744.7879331475, 7581870.127764323, 7567321.138544995, 7553059.719878059, 7539262.738502567, 7525738.222341838, 7511878.094456677, 7498309.51640095, 7484854.313634333, 7471701.625648219, 7458752.79256065, 7445159.875926154, 7431852.057868841, 7418508.744919236, 7405417.682720897, 7392704.963660491, 7381278.518240873, 7370063.808364399, 7359084.139153642, 7348332.044878572, 7337812.107660628, 7327046.359514276, 7316065.398109987, 7305725.935016779, 7295198.323737533, 7285267.994116156, 7272916.909200392, 7260764.5710398005, 7249010.291124305, 7237363.987533074, 7226175.069343732, 7215174.182625108, 7204343.698336096, 7193805.324384839, 7183427.783267442, 7173333.152729705, 7163881.3162736, 7153173.246816697, 7142695.344895052, 7132413.064394695, 7122916.49973363, 7113842.067810103, 7104877.98533715, 7096153.363139457, 7087612.47103402, 7079096.938779095, 7070830.075677799, 7061912.466224057, 7054197.737318658, 7045559.428066909, 7038102.301594928, 7028051.540693279, 7018257.867357494, 7009306.272426338, 6999677.518131344, 6990299.55977275, 6982249.731388006, 6974378.48996151, 6965423.318439948, 6957822.726948083, 6949179.280512642, 6939507.140795784, 6930047.295988422, 6920794.657249754, 6911745.097536577, 6902387.981888065, 6894759.417923842, 6887301.040438195, 6879968.168131771, 6872826.788221299, 6865613.745298194, 6858198.402614111, 6851142.950001324, 6844336.353742508, 6837675.294304914, 6831175.799493703, 6824922.516977996, 6818806.100128802, 6811866.470770004, 6805957.833717256, 6799884.721039065, 6794208.511450749, 6788335.563089769, 6782888.187305658, 6777421.526543579, 6772159.013897007, 6765518.624577993, 6759042.910480699, 6752690.43164596, 6746186.26835785, 6739825.203938326, 6732811.563915944, 6725964.010113207, 6719365.454227125, 6713139.240200923, 6706596.340367615, 6699987.961904459, 6692980.901564028, 6687200.991639962, 6680485.973600874, 6674414.280201093, 6668087.315792494, 6661897.476784499, 6655959.230496306, 6650372.950706432, 6644091.411425955, 6638863.071573501, 6633756.2655787505, 6628655.294742916, 6623680.213094584, 6618917.276734608, 6614349.801239267, 6610037.725271151, 6605726.119886373, 6601729.050599554, 6597673.464748224, 6592955.92324143, 6588345.660204992, 6583840.4083629735, 6579437.946795745, 6575136.328368121, 6570870.10003463, 6566705.418771122, 6562669.724446483, 6558699.351181608, 6554824.154665261, 6550556.9637165675, 6546386.216076019, 6542309.878682065, 6538279.313506881, 6534146.057306933, 6528513.079540238, 6522144.063339142, 6516722.261658936, 6510509.887602375, 6504458.314075085, 6499279.612841153, 6494103.828509439, 6489147.194081698, 6484718.832985285, 6479852.282039134, 6473017.080075016, 6466289.255003182, 6460059.547892395, 6453979.910059383, 6448495.732406606, 6444633.115379333, 6440894.902595415, 6436941.310891867, 6433086.301446749, 6429303.390268537, 6426017.483599896, 6422803.748485127, 6419660.681988179, 6416164.882726186, 6412745.809950661, 6407431.43217614, 6402194.614376732, 6397231.988040589, 6392217.903628895, 6387470.236277922, 6384242.734033922, 6381086.825797167, 6378017.472178026, 6374991.147345582, 6372032.205445787, 6366190.206171675, 6360461.65831737, 6354882.4497440765, 6349409.207096396, 6344077.471215495, 6339979.249383547, 6336044.999401964, 6332146.086992244, 6328383.49450053, 6324839.445957821, 6322497.028224604, 6320207.216801563, 6317977.652849318, 6315798.310524168, 6313668.132735507, 6309854.953907828, 6306078.363775199, 6302368.00401771, 6298374.580964158, 6294723.197195155, 6291378.984249474, 6288115.390799467, 6284866.918699738, 6281689.31418334, 6278657.315010612, 6274016.976972173, 6269502.817305771, 6265448.566004571, 6261124.398789023, 6256805.676835811, 6255090.399772838, 6252197.12398829, 6248716.443314584, 6246337.427332905, 6244694.501882904, 6241402.13991623, 6238185.644161756, 6234893.282613091, 6232769.233936744, 6229416.140203772, 6227007.192830653, 6224636.218324373, 6222326.964514935, 6220078.058888251, 6216982.08590513, 6215045.866016312, 6213698.887667848, 6211740.048615784, 6208974.533800091, 6206356.350800069, 6202657.6506005665, 6198904.773808114, 6195954.731537001, 6191940.4646626655, 6188376.47062618, 6185666.632573152, 6182298.373048264, 6179055.687784687, 6175893.645924384, 6173620.779718015, 6169663.940607253, 6165816.006227849, 6162037.657698666, 6158350.096044052, 6154692.482676655, 6152968.536388997, 6151722.873419016, 6150056.542934931, 6149071.864060216, 6147893.19268912, 6144624.865548329, 6141342.79307789, 6138379.827658664, 6135484.0509557985, 6132656.227489423, 6130056.2557022115, 6127517.775493663, 6125039.466728687, 6122620.036424048, 6120258.218344637, 6116929.354449827, 6115199.433014075, 6111898.081809935, 6110486.232769784, 6109109.5263395, 6107044.267622977, 6104992.516689767, 6103102.37332257, 6101368.137445907, 6099511.8223706065, 6097979.211003119, 6096482.653185017, 6095021.376424787, 6093594.624108066, 6092201.655219758, 6087435.697308627, 6083124.976619272, 6078927.247016445, 6074872.085681367, 6072397.626039703, 6070423.028543899, 6068490.999578642, 6066774.510360597, 6065098.136143308, 6063272.009136806, 6060377.629259341, 6057103.585504688, 6054329.1223873915, 6051182.653754042, 6048523.258621891, 6046367.508511582, 6044256.322398064, 6042236.896054202, 6040210.074929925, 6038230.706869752, 6035308.318321127, 6032453.083393174, 6029527.078576496, 6026477.612747291, 6023333.99328134, 6020618.167479434, 6017972.835948429, 6015401.991223537, 6012788.337274603, 6010335.466450195])])
valid: OrderedDict([('l2', [53124293.895417936, 53022060.778796695, 52916970.39798651, 52820566.57335308, 52723548.23416552, 52597448.480167106, 52474681.21732355, 52352617.98722755, 52245101.57632615, 52129230.9240378, 52023135.87841521, 51917833.1159649, 51815161.19147513, 51715006.97474483, 51612061.16505968, 51523314.018073216, 51435243.49774776, 51345727.12881613, 51260941.50583827, 51176375.095062844, 51107741.384508, 51040312.30394841, 50968500.73790903, 50900197.575841054, 50824648.773127824, 50736287.4169774, 50649375.24475019, 50563886.517726734, 50479795.97710573, 50402632.20553151, 50340239.01572228, 50275293.26475293, 50211442.098349065, 50153252.55405822, 50092042.55679953, 50028526.68266696, 49961819.62769496, 49900324.10356763, 49837306.07205098, 49780129.30071595, 49727393.60027293, 49675944.80714634, 49625009.27819131, 49575693.15201122, 49526488.59041471, 49467939.841432944, 49405636.68905121, 49353375.304297246, 49296635.55277811, 49242205.71446729, 49190861.25493708, 49138196.18117475, 49085222.4631424, 49038385.6762817, 48989384.31025925, 48945483.900033146, 48898437.421678066, 48855754.69905732, 48812125.36593301, 48765558.84232551, 48713072.87102874, 48662020.64059363, 48615941.628205135, 48570942.77094148, 48526244.3427065, 48501977.153162025, 48477524.82452827, 48454249.09580631, 48430549.17965573, 48408230.475090034, 48365012.69041467, 48323276.362952106, 48279376.05424808, 48236818.08039121, 48199046.037304215, 48160673.987502724, 48121529.19679745, 48084296.9222826, 48049037.03444613, 48014345.42824394, 47967241.67167476, 47923497.844211906, 47877719.66952568, 47835250.22566369, 47793419.42524596, 47764668.102124035, 47736004.32851524, 47707315.54506275, 47687713.2009239, 47660974.21633419, 47646476.18963799, 47637741.8018214, 47623544.81474975, 47609150.38641171, 47596438.02026322, 47578265.32694816, 47560148.787984, 47542668.17489816, 47524040.2185081, 47506039.66709259, 47483887.83806557, 47462125.86736156, 47436251.66142085, 47420218.45564431, 47395091.81498682, 47367412.46269838, 47340180.78642089, 47316961.810914755, 47296696.01227124, 47274231.20041176, 47256607.682471775, 47228979.30426187, 47201965.965104766, 47175186.613103904, 47155863.832989246, 47137339.2385566, 47117091.06765872, 47099212.36890569, 47079708.22118166, 47062453.38234073, 47037503.09237373, 47012034.85095188, 46983678.62916284, 46959033.56697159, 46933750.0165754, 46919680.425958514, 46903239.95870393, 46889724.73699801, 46873864.38730325, 46860881.933863446, 46837253.051102936, 46822476.54194205, 46807991.232032664, 46792205.279926, 46766651.211495675, 46750516.396643415, 46737034.657743685, 46721397.27687776, 46706913.667956576, 46691321.76845811, 46692535.9532145, 46688202.07328276, 46684183.3105728, 46680046.618732065, 46676207.896392345, 46666740.95167922, 46657922.46718879, 46652597.33481587, 46641018.363311894, 46630098.419399925, 46620161.4239055, 46610431.27042984, 46595128.26064121, 46586964.33848071, 46572094.04728405, 46570759.38276917, 46569566.56741385, 46569024.52372804, 46568101.68472351, 46560040.80369601, 46541022.8966153, 46522305.36046572, 46501768.987065695, 46483492.17143729, 46464317.03912168, 46456622.185413316, 46448697.8573482, 46440445.12329784, 46426338.86567241, 46411791.931085296, 46397302.22798937, 46383027.524727955, 46366900.54265579, 46352998.84823163, 46338493.65407463, 46327092.38370433, 46311241.91641263, 46300200.981600724, 46291710.73430463, 46281535.6225152, 46279700.19528474, 46277052.15072855, 46275375.57164437, 46267944.51291061, 46260654.860183105, 46262165.14551244, 46263772.6808724, 46264350.14889262, 46263811.34218626, 46261048.76980127, 46257137.663144484, 46250500.90735706, 46245948.72797763, 46239620.16739998, 46236256.65567602, 46199796.55588921, 46163794.98606446, 46131218.86588824, 46100134.7482434, 46068392.61609405, 46068072.00159528, 46067825.90058775, 46069451.31891621, 46071311.63582023, 46071268.179737344, 46066962.44336118, 46061127.700160235, 46056128.234846495, 46052903.863520674, 46047423.64358196, 46045461.39150838, 46043583.96146092, 46041789.21022151, 46040075.04125657, 46034028.84991751, 46022845.34899135, 46011849.47648498, 46000405.596140854, 45989780.76861004, 45979333.606324255, 45977919.64499198, 45976574.03609381, 45975295.01913832, 45970245.75772141, 45966188.16278336, 45964726.92442762, 45960128.563412994, 45958861.2800868, 45953854.58401826, 45948734.83676826, 45931404.94035249, 45911536.645040505, 45894681.92850264, 45874780.141768865, 45855654.65949728, 45850971.998374596, 45846313.5942574, 45847233.98093508, 45848243.00871557, 45848631.923120454, 45840343.419358656, 45829875.82285455, 45823626.544884026, 45817438.286349006, 45811419.182604775, 45810513.41834333, 45809019.577130824, 45808207.120124795, 45804292.08334419, 45801069.130494416, 45790749.890854515, 45779022.247124635, 45768961.37417113, 45756894.16404399, 45747182.59054186, 45748936.21115002, 45750708.102640994, 45754796.40829019, 45756602.24260883, 45758423.879684806, 45751511.132975124, 45745504.52081496, 45738918.64613684, 45733225.68052937, 45726952.852141775, 45720462.392486624, 45713709.528140076, 45707494.33903133, 45700903.83888283, 45697651.08792945, 45692412.82739849, 45687262.60822135, 45681598.58721233, 45676020.495194376, 45670526.8909507, 45664572.35275679, 45658850.520147905, 45653070.40396308, 45642782.44050284, 45637321.13421098, 45633594.08638325, 45629964.42355744, 45626104.21441003, 45621472.364029445, 45618960.31897076, 45620898.50153509, 45622190.50202845, 45629320.39288475, 45629277.32285416, 45633070.44991227, 45631124.98187689, 45630369.32107925, 45626963.660245664, 45625833.45577489, 45623965.19312585, 45629099.17679633, 45634228.26440023, 45627031.60891801, 45625550.73765092, 45622325.190536104, 45624277.81954939, 45625789.71696421, 45627323.7032944, 45628878.81991843, 45631714.87340535, 45635148.84802165, 45640599.873068176, 45644879.06576441, 45645017.56177193, 45650749.9860497, 45654695.82515711, 45653537.55367043, 45657402.20407036, 45649600.62309601, 45648610.30837333, 45648071.48732696, 45649397.769163884, 45649292.21580488, 45649821.030286446, 45647686.555893235, 45631352.229002096, 45613875.19596288, 45597985.70142003, 45582225.33664142, 45565793.64586818, 45565874.12310077, 45563846.830926135, 45563991.277315676, 45560538.31238348, 45558638.893116705, 45553290.0352007, 45550525.228195645, 45545241.89497183, 45539666.0857137, 45534217.24956667, 45544358.90336269, 45554430.89218618, 45564433.28317168, 45574366.15467119, 45584229.59531031, 45579119.79145297, 45576144.05348401, 45571056.37764144, 45568089.28881066, 45565173.54977028, 45564941.39253754, 45564839.34136824, 45564934.80761503, 45566771.79921117, 45567363.07782287, 45566099.46481009, 45564870.623567246, 45563675.76653422, 45562514.12221162, 45561384.93534218, 45561284.36808686, 45562558.54818293, 45562778.47274872, 45563735.44945454, 45569432.458395764, 45571284.14849865, 45573087.5219076, 45575300.910568714, 45577514.751453884, 45579348.21514136, 45587554.07546397, 45597103.921391614, 45605207.34249263, 45614651.59081997, 45622651.85667368, 45626255.059837215, 45628012.81689507, 45626695.94225818, 45623299.41784602, 45619961.26835548, 45617228.73466762, 45614558.427197024, 45612887.10288167, 45608133.50083964, 45606628.51006122, 45614049.84980221, 45621440.14367475, 45628964.61723953, 45631686.74934838, 45638461.171472006])])

Making predictions...

Sample predictions:
datetime    instrument
2024-01-01  ^NSEI_RAW_10YRS    13782.782514
2024-01-02  ^NSEI_RAW_10YRS    10147.815272
2024-01-03  ^NSEI_RAW_10YRS    11640.295060
2024-01-04  ^NSEI_RAW_10YRS    11017.923125
2024-01-05  ^NSEI_RAW_10YRS    11428.206914
dtype: float64
[17812:MainThread](2025-05-09 16:59:31,532) INFO - qlib.timer - [log.py:127] - Time cost: 2.554s | waiting `async_log` Done
Model saved in LightGBM format at: E:\Finance Internship\TASK_5\NSEI\train-test\models\20250509_165915\model.txt
Config saved at: E:\Finance Internship\TASK_5\NSEI\train-test\models\20250509_165915\config.json

-------------------------- Metric --------------------------
MSE:                      106053970.7739
RMSE:                         10298.2509
MAE:                          10087.9235
R²:                             -63.6937
Correlation:                      0.0295
Direction Accuracy:               52.85%











######################################################################################################################################











(qlib_env) PS E:\Finance Internship\TASK_5\NSEI> python .\model_raw.py
[3780:MainThread](2025-05-09 16:55:20,545) INFO - qlib.Initialization - [config.py:420] - default_conf: client.
[3780:MainThread](2025-05-09 16:55:20,560) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3780:MainThread](2025-05-09 16:55:20,560) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': WindowsPath('C:/Users/ASUS/.qlib/qlib_data/NSEI_raw_10yrs')}
Raw data shape: (1895, 5)
Raw data NaN count per column:
$open      0
$high      0
$low       0
$close     0
$volume    0
dtype: int64
                                  $open        $high         $low       $close   $volume
instrument      datetime
^NSEI_RAW_10YRS 2015-04-24  8405.700195  8413.299805  8273.349609  8305.250000  173600.0
                2015-04-27  8330.549805  8334.450195  8202.349609  8213.799805  171500.0
                2015-04-28  8215.549805  8308.000000  8185.149902  8285.599609  174600.0
                2015-04-29  8274.799805  8308.200195  8219.200195  8239.750000  160400.0
                2015-04-30  8224.500000  8229.400391  8144.750000  8181.500000  267700.0

Available instruments: {'market': 'all', 'filter_pipe': []}
Final feature expressions: ['($close - Ref($close, 1)) / Ref($close, 1)', 'Std($close, 5)', '($volume - Ref($volume, 1)) / Ref($volume, 1)']
Feature names: ['returns_(close-Ref(', 'volatility_Std(close,5)', 'volume_change_(volume-Ref(']
[3780:MainThread](2025-05-09 16:55:23,743) INFO - qlib.timer - [log.py:127] - Time cost: 0.026s | Loading data Done
[3780:MainThread](2025-05-09 16:55:23,744) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | fit & process data Done
[3780:MainThread](2025-05-09 16:55:23,745) INFO - qlib.timer - [log.py:127] - Time cost: 0.029s | Init data Done

Dataset information:
Training data shapes:
('feature', 'returns_(close-Ref(') shape: (1895,)
('feature', 'volatility_Std(close,5)') shape: (1895,)
('feature', 'volume_change_(volume-Ref(') shape: (1895,)
('label', 'NEXT_CLOSE') shape: (1895,)

Available columns in the dataset:
MultiIndex([('feature',        'returns_(close-Ref('),
            ('feature',    'volatility_Std(close,5)'),
            ('feature', 'volume_change_(volume-Ref('),
            (  'label',                 'NEXT_CLOSE')],
           )
Train data after processing: (1895, 4)
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

NaN count per column:
feature  returns_(close-Ref(           1
         volatility_Std(close,5)       1
         volume_change_(volume-Ref(    2
label    NEXT_CLOSE                    0
dtype: int64

Rows with all NaN values:
Empty DataFrame
Columns: [(feature, returns_(close-Ref(), (feature, volatility_Std(close,5)), (feature, volume_change_(volume-Ref(), (label, NEXT_CLOSE)]   
Index: []

Rows with at least one non-NaN value:
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

Feature Correlations:
Highly correlated features:

Do you want to proceed with training? (y/n): y
[3780:MainThread](2025-05-09 16:56:03,107) INFO - qlib.workflow - [exp.py:258] - Experiment 208382467731689026 starts running ...
[3780:MainThread](2025-05-09 16:56:03,374) INFO - qlib.workflow - [recorder.py:345] - Recorder 91f4fdef2e2941c6a35b4760c09f6324 starts running under Experiment 208382467731689026 ...

Training model...
Training until validation scores don't improve for 50 rounds
[20]    train's l2: 9.63014e+06 valid's l2: 5.11764e+07
[40]    train's l2: 8.83452e+06 valid's l2: 4.97801e+07
[60]    train's l2: 8.26188e+06 valid's l2: 4.87656e+07
[80]    train's l2: 7.84772e+06 valid's l2: 4.80143e+07
[100]   train's l2: 7.52574e+06 valid's l2: 4.7506e+07
[120]   train's l2: 7.28527e+06 valid's l2: 4.70625e+07
[140]   train's l2: 7.0791e+06  valid's l2: 4.66913e+07
[160]   train's l2: 6.90239e+06 valid's l2: 4.656e+07
[180]   train's l2: 6.77216e+06 valid's l2: 4.62815e+07
[200]   train's l2: 6.64409e+06 valid's l2: 4.60684e+07
[220]   train's l2: 6.55482e+06 valid's l2: 4.59793e+07
[240]   train's l2: 6.4485e+06  valid's l2: 4.58486e+07
[260]   train's l2: 6.37203e+06 valid's l2: 4.57584e+07
[280]   train's l2: 6.29472e+06 valid's l2: 4.56373e+07
[300]   train's l2: 6.22942e+06 valid's l2: 4.56223e+07
[320]   train's l2: 6.17362e+06 valid's l2: 4.56477e+07
[340]   train's l2: 6.12026e+06 valid's l2: 4.55842e+07
[360]   train's l2: 6.0724e+06  valid's l2: 4.55694e+07
[380]   train's l2: 6.02333e+06 valid's l2: 4.56066e+07
Early stopping, best iteration is:
[335]   train's l2: 6.13266e+06 valid's l2: 4.55342e+07

Training Metrics:
train: OrderedDict([('l2', [10699600.158484442, 10633331.2495526, 10569109.950164096, 10505142.432186686, 10442537.269416708, 10381999.05221954, 10322622.558123603, 10264514.125469605, 10207697.089352207, 10150287.085507678, 10093469.10181894, 10037642.217206521, 9983101.056414833, 9929654.339120904, 9877475.826827662, 9826188.735784244, 9775820.902471358, 9726055.11160674, 9677775.632459188, 9630143.446310427, 9585546.775037635, 9541843.529606724, 9497953.608512126, 9455596.94656511, 9414314.511479465, 9370618.164252974, 9327808.734489165, 9285868.40853311, 9244779.729131918, 9204558.38461805, 9164279.929709861, 9125188.682249434, 9086902.922136975, 9048965.46857426, 9012189.103564283, 8975229.154728185, 8938993.479738517, 8903463.673329994, 8868668.440205473, 8834518.761983152, 8801053.943432638, 8768188.807818366, 8736078.48916626, 8704571.710935885, 8673760.716333203, 8642725.312955039, 8612877.18226933, 8583463.38286612, 8554175.617471604, 8526136.515412655, 8497727.172419671, 8469873.591500008, 8442545.063820463, 8416304.702667855, 8389774.56768782, 8363245.695596023, 8337046.119326575, 8311999.097883654, 8286707.452427342, 8261883.310615587, 8237067.34603691, 8212810.378629315, 8189161.341984027, 8165931.685399131, 8143230.511115198, 8121425.667840032, 8100088.083623974, 8079173.830308321, 8058705.6172979465, 8038639.196338175, 8018478.66248476, 7998335.979001325, 7978137.369171016, 7958773.47415949, 7939739.274286641, 7920458.618604857, 7901753.09956528, 7883215.031511822, 7865282.848407742, 7847723.541862798, 7830467.423372642, 7812940.042725233, 7796380.281787239, 7779546.836277843, 7763665.883859372, 7746299.179267759, 7729192.107447326, 7712090.145061841, 7694871.105796582, 7678831.060370659, 7661557.878680661, 7644766.903320994, 7628509.464077427, 7612194.509112312, 7596744.7879331475, 7581870.127764323, 7567321.138544995, 7553059.719878059, 7539262.738502567, 7525738.222341838, 7511878.094456677, 7498309.51640095, 7484854.313634333, 7471701.625648219, 7458752.79256065, 7445159.875926154, 7431852.057868841, 7418508.744919236, 7405417.682720897, 7392704.963660491, 7381278.518240873, 7370063.808364399, 7359084.139153642, 7348332.044878572, 7337812.107660628, 7327046.359514276, 7316065.398109987, 7305725.935016779, 7295198.323737533, 7285267.994116156, 7272916.909200392, 7260764.5710398005, 7249010.291124305, 7237363.987533074, 7226175.069343732, 7215174.182625108, 7204343.698336096, 7193805.324384839, 7183427.783267442, 7173333.152729705, 7163881.3162736, 7153173.246816697, 7142695.344895052, 7132413.064394695, 7122916.49973363, 7113842.067810103, 7104877.98533715, 7096153.363139457, 7087612.47103402, 7079096.938779095, 7070830.075677799, 7061912.466224057, 7054197.737318658, 7045559.428066909, 7038102.301594928, 7028051.540693279, 7018257.867357494, 7009306.272426338, 6999677.518131344, 6990299.55977275, 6982249.731388006, 6974378.48996151, 6965423.318439948, 6957822.726948083, 6949179.280512642, 6939507.140795784, 6930047.295988422, 6920794.657249754, 6911745.097536577, 6902387.981888065, 6894759.417923842, 6887301.040438195, 6879968.168131771, 6872826.788221299, 6865613.745298194, 6858198.402614111, 6851142.950001324, 6844336.353742508, 6837675.294304914, 6831175.799493703, 6824922.516977996, 6818806.100128802, 6811866.470770004, 6805957.833717256, 6799884.721039065, 6794208.511450749, 6788335.563089769, 6782888.187305658, 6777421.526543579, 6772159.013897007, 6765518.624577993, 6759042.910480699, 6752690.43164596, 6746186.26835785, 6739825.203938326, 6732811.563915944, 6725964.010113207, 6719365.454227125, 6713139.240200923, 6706596.340367615, 6699987.961904459, 6692980.901564028, 6687200.991639962, 6680485.973600874, 6674414.280201093, 6668087.315792494, 6661897.476784499, 6655959.230496306, 6650372.950706432, 6644091.411425955, 6638863.071573501, 6633756.2655787505, 6628655.294742916, 6623680.213094584, 6618917.276734608, 6614349.801239267, 6610037.725271151, 6605726.119886373, 6601729.050599554, 6597673.464748224, 6592955.92324143, 6588345.660204992, 6583840.4083629735, 6579437.946795745, 6575136.328368121, 6570870.10003463, 6566705.418771122, 6562669.724446483, 6558699.351181608, 6554824.154665261, 6550556.9637165675, 6546386.216076019, 6542309.878682065, 6538279.313506881, 6534146.057306933, 6528513.079540238, 6522144.063339142, 6516722.261658936, 6510509.887602375, 6504458.314075085, 6499279.612841153, 6494103.828509439, 6489147.194081698, 6484718.832985285, 6479852.282039134, 6473017.080075016, 6466289.255003182, 6460059.547892395, 6453979.910059383, 6448495.732406606, 6444633.115379333, 6440894.902595415, 6436941.310891867, 6433086.301446749, 6429303.390268537, 6426017.483599896, 6422803.748485127, 6419660.681988179, 6416164.882726186, 6412745.809950661, 6407431.43217614, 6402194.614376732, 6397231.988040589, 6392217.903628895, 6387470.236277922, 6384242.734033922, 6381086.825797167, 6378017.472178026, 6374991.147345582, 6372032.205445787, 6366190.206171675, 6360461.65831737, 6354882.4497440765, 6349409.207096396, 6344077.471215495, 6339979.249383547, 6336044.999401964, 6332146.086992244, 6328383.49450053, 6324839.445957821, 6322497.028224604, 6320207.216801563, 6317977.652849318, 6315798.310524168, 6313668.132735507, 6309854.953907828, 6306078.363775199, 6302368.00401771, 6298374.580964158, 6294723.197195155, 6291378.984249474, 6288115.390799467, 6284866.918699738, 6281689.31418334, 6278657.315010612, 6274016.976972173, 6269502.817305771, 6265448.566004571, 6261124.398789023, 6256805.676835811, 6255090.399772838, 6252197.12398829, 6248716.443314584, 6246337.427332905, 6244694.501882904, 6241402.13991623, 6238185.644161756, 6234893.282613091, 6232769.233936744, 6229416.140203772, 6227007.192830653, 6224636.218324373, 6222326.964514935, 6220078.058888251, 6216982.08590513, 6215045.866016312, 6213698.887667848, 6211740.048615784, 6208974.533800091, 6206356.350800069, 6202657.6506005665, 6198904.773808114, 6195954.731537001, 6191940.4646626655, 6188376.47062618, 6185666.632573152, 6182298.373048264, 6179055.687784687, 6175893.645924384, 6173620.779718015, 6169663.940607253, 6165816.006227849, 6162037.657698666, 6158350.096044052, 6154692.482676655, 6152968.536388997, 6151722.873419016, 6150056.542934931, 6149071.864060216, 6147893.19268912, 6144624.865548329, 6141342.79307789, 6138379.827658664, 6135484.0509557985, 6132656.227489423, 6130056.2557022115, 6127517.775493663, 6125039.466728687, 6122620.036424048, 6120258.218344637, 6116929.354449827, 6115199.433014075, 6111898.081809935, 6110486.232769784, 6109109.5263395, 6107044.267622977, 6104992.516689767, 6103102.37332257, 6101368.137445907, 6099511.8223706065, 6097979.211003119, 6096482.653185017, 6095021.376424787, 6093594.624108066, 6092201.655219758, 6087435.697308627, 6083124.976619272, 6078927.247016445, 6074872.085681367, 6072397.626039703, 6070423.028543899, 6068490.999578642, 6066774.510360597, 6065098.136143308, 6063272.009136806, 6060377.629259341, 6057103.585504688, 6054329.1223873915, 6051182.653754042, 6048523.258621891, 6046367.508511582, 6044256.322398064, 6042236.896054202, 6040210.074929925, 6038230.706869752, 6035308.318321127, 6032453.083393174, 6029527.078576496, 6026477.612747291, 6023333.99328134, 6020618.167479434, 6017972.835948429, 6015401.991223537, 6012788.337274603, 6010335.466450195])])
valid: OrderedDict([('l2', [53124293.895417936, 53022060.778796695, 52916970.39798651, 52820566.57335308, 52723548.23416552, 52597448.480167106, 52474681.21732355, 52352617.98722755, 52245101.57632615, 52129230.9240378, 52023135.87841521, 51917833.1159649, 51815161.19147513, 51715006.97474483, 51612061.16505968, 51523314.018073216, 51435243.49774776, 51345727.12881613, 51260941.50583827, 51176375.095062844, 51107741.384508, 51040312.30394841, 50968500.73790903, 50900197.575841054, 50824648.773127824, 50736287.4169774, 50649375.24475019, 50563886.517726734, 50479795.97710573, 50402632.20553151, 50340239.01572228, 50275293.26475293, 50211442.098349065, 50153252.55405822, 50092042.55679953, 50028526.68266696, 49961819.62769496, 49900324.10356763, 49837306.07205098, 49780129.30071595, 49727393.60027293, 49675944.80714634, 49625009.27819131, 49575693.15201122, 49526488.59041471, 49467939.841432944, 49405636.68905121, 49353375.304297246, 49296635.55277811, 49242205.71446729, 49190861.25493708, 49138196.18117475, 49085222.4631424, 49038385.6762817, 48989384.31025925, 48945483.900033146, 48898437.421678066, 48855754.69905732, 48812125.36593301, 48765558.84232551, 48713072.87102874, 48662020.64059363, 48615941.628205135, 48570942.77094148, 48526244.3427065, 48501977.153162025, 48477524.82452827, 48454249.09580631, 48430549.17965573, 48408230.475090034, 48365012.69041467, 48323276.362952106, 48279376.05424808, 48236818.08039121, 48199046.037304215, 48160673.987502724, 48121529.19679745, 48084296.9222826, 48049037.03444613, 48014345.42824394, 47967241.67167476, 47923497.844211906, 47877719.66952568, 47835250.22566369, 47793419.42524596, 47764668.102124035, 47736004.32851524, 47707315.54506275, 47687713.2009239, 47660974.21633419, 47646476.18963799, 47637741.8018214, 47623544.81474975, 47609150.38641171, 47596438.02026322, 47578265.32694816, 47560148.787984, 47542668.17489816, 47524040.2185081, 47506039.66709259, 47483887.83806557, 47462125.86736156, 47436251.66142085, 47420218.45564431, 47395091.81498682, 47367412.46269838, 47340180.78642089, 47316961.810914755, 47296696.01227124, 47274231.20041176, 47256607.682471775, 47228979.30426187, 47201965.965104766, 47175186.613103904, 47155863.832989246, 47137339.2385566, 47117091.06765872, 47099212.36890569, 47079708.22118166, 47062453.38234073, 47037503.09237373, 47012034.85095188, 46983678.62916284, 46959033.56697159, 46933750.0165754, 46919680.425958514, 46903239.95870393, 46889724.73699801, 46873864.38730325, 46860881.933863446, 46837253.051102936, 46822476.54194205, 46807991.232032664, 46792205.279926, 46766651.211495675, 46750516.396643415, 46737034.657743685, 46721397.27687776, 46706913.667956576, 46691321.76845811, 46692535.9532145, 46688202.07328276, 46684183.3105728, 46680046.618732065, 46676207.896392345, 46666740.95167922, 46657922.46718879, 46652597.33481587, 46641018.363311894, 46630098.419399925, 46620161.4239055, 46610431.27042984, 46595128.26064121, 46586964.33848071, 46572094.04728405, 46570759.38276917, 46569566.56741385, 46569024.52372804, 46568101.68472351, 46560040.80369601, 46541022.8966153, 46522305.36046572, 46501768.987065695, 46483492.17143729, 46464317.03912168, 46456622.185413316, 46448697.8573482, 46440445.12329784, 46426338.86567241, 46411791.931085296, 46397302.22798937, 46383027.524727955, 46366900.54265579, 46352998.84823163, 46338493.65407463, 46327092.38370433, 46311241.91641263, 46300200.981600724, 46291710.73430463, 46281535.6225152, 46279700.19528474, 46277052.15072855, 46275375.57164437, 46267944.51291061, 46260654.860183105, 46262165.14551244, 46263772.6808724, 46264350.14889262, 46263811.34218626, 46261048.76980127, 46257137.663144484, 46250500.90735706, 46245948.72797763, 46239620.16739998, 46236256.65567602, 46199796.55588921, 46163794.98606446, 46131218.86588824, 46100134.7482434, 46068392.61609405, 46068072.00159528, 46067825.90058775, 46069451.31891621, 46071311.63582023, 46071268.179737344, 46066962.44336118, 46061127.700160235, 46056128.234846495, 46052903.863520674, 46047423.64358196, 46045461.39150838, 46043583.96146092, 46041789.21022151, 46040075.04125657, 46034028.84991751, 46022845.34899135, 46011849.47648498, 46000405.596140854, 45989780.76861004, 45979333.606324255, 45977919.64499198, 45976574.03609381, 45975295.01913832, 45970245.75772141, 45966188.16278336, 45964726.92442762, 45960128.563412994, 45958861.2800868, 45953854.58401826, 45948734.83676826, 45931404.94035249, 45911536.645040505, 45894681.92850264, 45874780.141768865, 45855654.65949728, 45850971.998374596, 45846313.5942574, 45847233.98093508, 45848243.00871557, 45848631.923120454, 45840343.419358656, 45829875.82285455, 45823626.544884026, 45817438.286349006, 45811419.182604775, 45810513.41834333, 45809019.577130824, 45808207.120124795, 45804292.08334419, 45801069.130494416, 45790749.890854515, 45779022.247124635, 45768961.37417113, 45756894.16404399, 45747182.59054186, 45748936.21115002, 45750708.102640994, 45754796.40829019, 45756602.24260883, 45758423.879684806, 45751511.132975124, 45745504.52081496, 45738918.64613684, 45733225.68052937, 45726952.852141775, 45720462.392486624, 45713709.528140076, 45707494.33903133, 45700903.83888283, 45697651.08792945, 45692412.82739849, 45687262.60822135, 45681598.58721233, 45676020.495194376, 45670526.8909507, 45664572.35275679, 45658850.520147905, 45653070.40396308, 45642782.44050284, 45637321.13421098, 45633594.08638325, 45629964.42355744, 45626104.21441003, 45621472.364029445, 45618960.31897076, 45620898.50153509, 45622190.50202845, 45629320.39288475, 45629277.32285416, 45633070.44991227, 45631124.98187689, 45630369.32107925, 45626963.660245664, 45625833.45577489, 45623965.19312585, 45629099.17679633, 45634228.26440023, 45627031.60891801, 45625550.73765092, 45622325.190536104, 45624277.81954939, 45625789.71696421, 45627323.7032944, 45628878.81991843, 45631714.87340535, 45635148.84802165, 45640599.873068176, 45644879.06576441, 45645017.56177193, 45650749.9860497, 45654695.82515711, 45653537.55367043, 45657402.20407036, 45649600.62309601, 45648610.30837333, 45648071.48732696, 45649397.769163884, 45649292.21580488, 45649821.030286446, 45647686.555893235, 45631352.229002096, 45613875.19596288, 45597985.70142003, 45582225.33664142, 45565793.64586818, 45565874.12310077, 45563846.830926135, 45563991.277315676, 45560538.31238348, 45558638.893116705, 45553290.0352007, 45550525.228195645, 45545241.89497183, 45539666.0857137, 45534217.24956667, 45544358.90336269, 45554430.89218618, 45564433.28317168, 45574366.15467119, 45584229.59531031, 45579119.79145297, 45576144.05348401, 45571056.37764144, 45568089.28881066, 45565173.54977028, 45564941.39253754, 45564839.34136824, 45564934.80761503, 45566771.79921117, 45567363.07782287, 45566099.46481009, 45564870.623567246, 45563675.76653422, 45562514.12221162, 45561384.93534218, 45561284.36808686, 45562558.54818293, 45562778.47274872, 45563735.44945454, 45569432.458395764, 45571284.14849865, 45573087.5219076, 45575300.910568714, 45577514.751453884, 45579348.21514136, 45587554.07546397, 45597103.921391614, 45605207.34249263, 45614651.59081997, 45622651.85667368, 45626255.059837215, 45628012.81689507, 45626695.94225818, 45623299.41784602, 45619961.26835548, 45617228.73466762, 45614558.427197024, 45612887.10288167, 45608133.50083964, 45606628.51006122, 45614049.84980221, 45621440.14367475, 45628964.61723953, 45631686.74934838, 45638461.171472006])])

Making predictions...

Sample predictions:
datetime    instrument
2024-01-01  ^NSEI_RAW_10YRS    13782.782514
2024-01-02  ^NSEI_RAW_10YRS    10147.815272
2024-01-03  ^NSEI_RAW_10YRS    11640.295060
2024-01-04  ^NSEI_RAW_10YRS    11017.923125
2024-01-05  ^NSEI_RAW_10YRS    11428.206914
dtype: float64
[3780:MainThread](2025-05-09 16:56:06,179) INFO - qlib.timer - [log.py:127] - Time cost: 1.857s | waiting `async_log` Done
Model saved in LightGBM format at: E:\Finance Internship\TASK_5\NSEI\train-test\models\20250509_165520\model.txt
Config saved at: E:\Finance Internship\TASK_5\NSEI\train-test\models\20250509_165520\config.json

-------------------------- Metric --------------------------
MSE:                      106053970.7739
RMSE:                         10298.2509
MAE:                          10087.9235
R²:                             -63.6937
Correlation:                      0.0295
Direction Accuracy:               52.85%
[3780:MainThread](2025-05-09 16:56:06,469) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[TypeError: Converting from datetime64[ns] to int32 is not supported. Do obj.astype('int64').astype(dtype) instead].
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 527, in <module>
    main()
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 336, in main
    test_results = test_model(model, dataset, exp_id)
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 398, in test_model
    scatter = ax2.scatter(results["actual"], results["predicted"], alpha=0.6, c=results.index.get_level_values(0).astype(int), cmap='viridis')
  File "E:\Finance Internship\qlib_env\lib\site-packages\pandas\core\indexes\base.py", line 1087, in astype
    new_values = values.astype(dtype, copy=copy)
  File "E:\Finance Internship\qlib_env\lib\site-packages\pandas\core\arrays\datetimes.py", line 739, in astype
    return dtl.DatetimeLikeArrayMixin.astype(self, dtype, copy)
  File "E:\Finance Internship\qlib_env\lib\site-packages\pandas\core\arrays\datetimelike.py", line 482, in astype
    raise TypeError(
TypeError: Converting from datetime64[ns] to int32 is not supported. Do obj.astype('int64').astype(dtype) instead













######################################################################################################################################













(qlib_env) PS E:\Finance Internship\TASK_5\NSEI> python .\model_raw.py
[8796:MainThread](2025-05-09 16:47:06,492) INFO - qlib.Initialization - [config.py:420] - default_conf: client.
[8796:MainThread](2025-05-09 16:47:06,503) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[8796:MainThread](2025-05-09 16:47:06,503) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': WindowsPath('C:/Users/ASUS/.qlib/qlib_data/NSEI_raw_10yrs')}
Raw data shape: (1895, 5)
Raw data NaN count per column:
$open      0
$high      0
$low       0
$close     0
$volume    0
dtype: int64
                                  $open        $high         $low       $close   $volume
instrument      datetime
^NSEI_RAW_10YRS 2015-04-24  8405.700195  8413.299805  8273.349609  8305.250000  173600.0
                2015-04-27  8330.549805  8334.450195  8202.349609  8213.799805  171500.0
                2015-04-28  8215.549805  8308.000000  8185.149902  8285.599609  174600.0
                2015-04-29  8274.799805  8308.200195  8219.200195  8239.750000  160400.0
                2015-04-30  8224.500000  8229.400391  8144.750000  8181.500000  267700.0

Available instruments: {'market': 'all', 'filter_pipe': []}
Final feature expressions: ['($close - Ref($close, 1)) / Ref($close, 1)', 'Std($close, 5)', '($volume - Ref($volume, 1)) / Ref($volume, 1)']
Feature names: ['returns_(close-Ref(', 'volatility_Std(close,5)', 'volume_change_(volume-Ref(']
[8796:MainThread](2025-05-09 16:47:11,244) INFO - qlib.timer - [log.py:127] - Time cost: 0.050s | Loading data Done
[8796:MainThread](2025-05-09 16:47:11,245) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | fit & process data Done
[8796:MainThread](2025-05-09 16:47:11,245) INFO - qlib.timer - [log.py:127] - Time cost: 0.051s | Init data Done

Dataset information:
Training data shapes:
('feature', 'returns_(close-Ref(') shape: (1895,)
('feature', 'volatility_Std(close,5)') shape: (1895,)
('feature', 'volume_change_(volume-Ref(') shape: (1895,)
('label', 'NEXT_CLOSE') shape: (1895,)

Available columns in the dataset:
MultiIndex([('feature',        'returns_(close-Ref('),
            ('feature',    'volatility_Std(close,5)'),
            ('feature', 'volume_change_(volume-Ref('),
            (  'label',                 'NEXT_CLOSE')],
           )
Train data after processing: (1895, 4)
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

NaN count per column:
feature  returns_(close-Ref(           1
         volatility_Std(close,5)       1
         volume_change_(volume-Ref(    2
label    NEXT_CLOSE                    0
dtype: int64

Rows with all NaN values:
Empty DataFrame
Columns: [(feature, returns_(close-Ref(), (feature, volatility_Std(close,5)), (feature, volume_change_(volume-Ref(), (label, NEXT_CLOSE)]   
Index: []

Rows with at least one non-NaN value:
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

Feature Correlations:
Highly correlated features:

Do you want to proceed with training? (y/n): y
[8796:MainThread](2025-05-09 16:47:18,804) INFO - qlib.workflow - [exp.py:258] - Experiment 208382467731689026 starts running ...
[8796:MainThread](2025-05-09 16:47:19,110) INFO - qlib.workflow - [recorder.py:345] - Recorder 0dd2cb7b3cb141fcbac64d7c2c73e52b starts running under Experiment 208382467731689026 ...

Training model...
Training until validation scores don't improve for 50 rounds
[20]    train's l2: 9.63014e+06 valid's l2: 5.11764e+07
[40]    train's l2: 8.83452e+06 valid's l2: 4.97801e+07
[60]    train's l2: 8.26188e+06 valid's l2: 4.87656e+07
[80]    train's l2: 7.84772e+06 valid's l2: 4.80143e+07
[100]   train's l2: 7.52574e+06 valid's l2: 4.7506e+07
[120]   train's l2: 7.28527e+06 valid's l2: 4.70625e+07
[140]   train's l2: 7.0791e+06  valid's l2: 4.66913e+07
[160]   train's l2: 6.90239e+06 valid's l2: 4.656e+07
[180]   train's l2: 6.77216e+06 valid's l2: 4.62815e+07
[200]   train's l2: 6.64409e+06 valid's l2: 4.60684e+07
[220]   train's l2: 6.55482e+06 valid's l2: 4.59793e+07
[240]   train's l2: 6.4485e+06  valid's l2: 4.58486e+07
[260]   train's l2: 6.37203e+06 valid's l2: 4.57584e+07
[280]   train's l2: 6.29472e+06 valid's l2: 4.56373e+07
[300]   train's l2: 6.22942e+06 valid's l2: 4.56223e+07
[320]   train's l2: 6.17362e+06 valid's l2: 4.56477e+07
[340]   train's l2: 6.12026e+06 valid's l2: 4.55842e+07
[360]   train's l2: 6.0724e+06  valid's l2: 4.55694e+07
[380]   train's l2: 6.02333e+06 valid's l2: 4.56066e+07
Early stopping, best iteration is:
[335]   train's l2: 6.13266e+06 valid's l2: 4.55342e+07

Training Metrics:
train: OrderedDict([('l2', [10699600.158484442, 10633331.2495526, 10569109.950164096, 10505142.432186686, 10442537.269416708, 10381999.05221954, 10322622.558123603, 10264514.125469605, 10207697.089352207, 10150287.085507678, 10093469.10181894, 10037642.217206521, 9983101.056414833, 9929654.339120904, 9877475.826827662, 9826188.735784244, 9775820.902471358, 9726055.11160674, 9677775.632459188, 9630143.446310427, 9585546.775037635, 9541843.529606724, 9497953.608512126, 9455596.94656511, 9414314.511479465, 9370618.164252974, 9327808.734489165, 9285868.40853311, 9244779.729131918, 9204558.38461805, 9164279.929709861, 9125188.682249434, 9086902.922136975, 9048965.46857426, 9012189.103564283, 8975229.154728185, 8938993.479738517, 8903463.673329994, 8868668.440205473, 8834518.761983152, 8801053.943432638, 8768188.807818366, 8736078.48916626, 8704571.710935885, 8673760.716333203, 8642725.312955039, 8612877.18226933, 8583463.38286612, 8554175.617471604, 8526136.515412655, 8497727.172419671, 8469873.591500008, 8442545.063820463, 8416304.702667855, 8389774.56768782, 8363245.695596023, 8337046.119326575, 8311999.097883654, 8286707.452427342, 8261883.310615587, 8237067.34603691, 8212810.378629315, 8189161.341984027, 8165931.685399131, 8143230.511115198, 8121425.667840032, 8100088.083623974, 8079173.830308321, 8058705.6172979465, 8038639.196338175, 8018478.66248476, 7998335.979001325, 7978137.369171016, 7958773.47415949, 7939739.274286641, 7920458.618604857, 7901753.09956528, 7883215.031511822, 7865282.848407742, 7847723.541862798, 7830467.423372642, 7812940.042725233, 7796380.281787239, 7779546.836277843, 7763665.883859372, 7746299.179267759, 7729192.107447326, 7712090.145061841, 7694871.105796582, 7678831.060370659, 7661557.878680661, 7644766.903320994, 7628509.464077427, 7612194.509112312, 7596744.7879331475, 7581870.127764323, 7567321.138544995, 7553059.719878059, 7539262.738502567, 7525738.222341838, 7511878.094456677, 7498309.51640095, 7484854.313634333, 7471701.625648219, 7458752.79256065, 7445159.875926154, 7431852.057868841, 7418508.744919236, 7405417.682720897, 7392704.963660491, 7381278.518240873, 7370063.808364399, 7359084.139153642, 7348332.044878572, 7337812.107660628, 7327046.359514276, 7316065.398109987, 7305725.935016779, 7295198.323737533, 7285267.994116156, 7272916.909200392, 7260764.5710398005, 7249010.291124305, 7237363.987533074, 7226175.069343732, 7215174.182625108, 7204343.698336096, 7193805.324384839, 7183427.783267442, 7173333.152729705, 7163881.3162736, 7153173.246816697, 7142695.344895052, 7132413.064394695, 7122916.49973363, 7113842.067810103, 7104877.98533715, 7096153.363139457, 7087612.47103402, 7079096.938779095, 7070830.075677799, 7061912.466224057, 7054197.737318658, 7045559.428066909, 7038102.301594928, 7028051.540693279, 7018257.867357494, 7009306.272426338, 6999677.518131344, 6990299.55977275, 6982249.731388006, 6974378.48996151, 6965423.318439948, 6957822.726948083, 6949179.280512642, 6939507.140795784, 6930047.295988422, 6920794.657249754, 6911745.097536577, 6902387.981888065, 6894759.417923842, 6887301.040438195, 6879968.168131771, 6872826.788221299, 6865613.745298194, 6858198.402614111, 6851142.950001324, 6844336.353742508, 6837675.294304914, 6831175.799493703, 6824922.516977996, 6818806.100128802, 6811866.470770004, 6805957.833717256, 6799884.721039065, 6794208.511450749, 6788335.563089769, 6782888.187305658, 6777421.526543579, 6772159.013897007, 6765518.624577993, 6759042.910480699, 6752690.43164596, 6746186.26835785, 6739825.203938326, 6732811.563915944, 6725964.010113207, 6719365.454227125, 6713139.240200923, 6706596.340367615, 6699987.961904459, 6692980.901564028, 6687200.991639962, 6680485.973600874, 6674414.280201093, 6668087.315792494, 6661897.476784499, 6655959.230496306, 6650372.950706432, 6644091.411425955, 6638863.071573501, 6633756.2655787505, 6628655.294742916, 6623680.213094584, 6618917.276734608, 6614349.801239267, 6610037.725271151, 6605726.119886373, 6601729.050599554, 6597673.464748224, 6592955.92324143, 6588345.660204992, 6583840.4083629735, 6579437.946795745, 6575136.328368121, 6570870.10003463, 6566705.418771122, 6562669.724446483, 6558699.351181608, 6554824.154665261, 6550556.9637165675, 6546386.216076019, 6542309.878682065, 6538279.313506881, 6534146.057306933, 6528513.079540238, 6522144.063339142, 6516722.261658936, 6510509.887602375, 6504458.314075085, 6499279.612841153, 6494103.828509439, 6489147.194081698, 6484718.832985285, 6479852.282039134, 6473017.080075016, 6466289.255003182, 6460059.547892395, 6453979.910059383, 6448495.732406606, 6444633.115379333, 6440894.902595415, 6436941.310891867, 6433086.301446749, 6429303.390268537, 6426017.483599896, 6422803.748485127, 6419660.681988179, 6416164.882726186, 6412745.809950661, 6407431.43217614, 6402194.614376732, 6397231.988040589, 6392217.903628895, 6387470.236277922, 6384242.734033922, 6381086.825797167, 6378017.472178026, 6374991.147345582, 6372032.205445787, 6366190.206171675, 6360461.65831737, 6354882.4497440765, 6349409.207096396, 6344077.471215495, 6339979.249383547, 6336044.999401964, 6332146.086992244, 6328383.49450053, 6324839.445957821, 6322497.028224604, 6320207.216801563, 6317977.652849318, 6315798.310524168, 6313668.132735507, 6309854.953907828, 6306078.363775199, 6302368.00401771, 6298374.580964158, 6294723.197195155, 6291378.984249474, 6288115.390799467, 6284866.918699738, 6281689.31418334, 6278657.315010612, 6274016.976972173, 6269502.817305771, 6265448.566004571, 6261124.398789023, 6256805.676835811, 6255090.399772838, 6252197.12398829, 6248716.443314584, 6246337.427332905, 6244694.501882904, 6241402.13991623, 6238185.644161756, 6234893.282613091, 6232769.233936744, 6229416.140203772, 6227007.192830653, 6224636.218324373, 6222326.964514935, 6220078.058888251, 6216982.08590513, 6215045.866016312, 6213698.887667848, 6211740.048615784, 6208974.533800091, 6206356.350800069, 6202657.6506005665, 6198904.773808114, 6195954.731537001, 6191940.4646626655, 6188376.47062618, 6185666.632573152, 6182298.373048264, 6179055.687784687, 6175893.645924384, 6173620.779718015, 6169663.940607253, 6165816.006227849, 6162037.657698666, 6158350.096044052, 6154692.482676655, 6152968.536388997, 6151722.873419016, 6150056.542934931, 6149071.864060216, 6147893.19268912, 6144624.865548329, 6141342.79307789, 6138379.827658664, 6135484.0509557985, 6132656.227489423, 6130056.2557022115, 6127517.775493663, 6125039.466728687, 6122620.036424048, 6120258.218344637, 6116929.354449827, 6115199.433014075, 6111898.081809935, 6110486.232769784, 6109109.5263395, 6107044.267622977, 6104992.516689767, 6103102.37332257, 6101368.137445907, 6099511.8223706065, 6097979.211003119, 6096482.653185017, 6095021.376424787, 6093594.624108066, 6092201.655219758, 6087435.697308627, 6083124.976619272, 6078927.247016445, 6074872.085681367, 6072397.626039703, 6070423.028543899, 6068490.999578642, 6066774.510360597, 6065098.136143308, 6063272.009136806, 6060377.629259341, 6057103.585504688, 6054329.1223873915, 6051182.653754042, 6048523.258621891, 6046367.508511582, 6044256.322398064, 6042236.896054202, 6040210.074929925, 6038230.706869752, 6035308.318321127, 6032453.083393174, 6029527.078576496, 6026477.612747291, 6023333.99328134, 6020618.167479434, 6017972.835948429, 6015401.991223537, 6012788.337274603, 6010335.466450195])])
valid: OrderedDict([('l2', [53124293.895417936, 53022060.778796695, 52916970.39798651, 52820566.57335308, 52723548.23416552, 52597448.480167106, 52474681.21732355, 52352617.98722755, 52245101.57632615, 52129230.9240378, 52023135.87841521, 51917833.1159649, 51815161.19147513, 51715006.97474483, 51612061.16505968, 51523314.018073216, 51435243.49774776, 51345727.12881613, 51260941.50583827, 51176375.095062844, 51107741.384508, 51040312.30394841, 50968500.73790903, 50900197.575841054, 50824648.773127824, 50736287.4169774, 50649375.24475019, 50563886.517726734, 50479795.97710573, 50402632.20553151, 50340239.01572228, 50275293.26475293, 50211442.098349065, 50153252.55405822, 50092042.55679953, 50028526.68266696, 49961819.62769496, 49900324.10356763, 49837306.07205098, 49780129.30071595, 49727393.60027293, 49675944.80714634, 49625009.27819131, 49575693.15201122, 49526488.59041471, 49467939.841432944, 49405636.68905121, 49353375.304297246, 49296635.55277811, 49242205.71446729, 49190861.25493708, 49138196.18117475, 49085222.4631424, 49038385.6762817, 48989384.31025925, 48945483.900033146, 48898437.421678066, 48855754.69905732, 48812125.36593301, 48765558.84232551, 48713072.87102874, 48662020.64059363, 48615941.628205135, 48570942.77094148, 48526244.3427065, 48501977.153162025, 48477524.82452827, 48454249.09580631, 48430549.17965573, 48408230.475090034, 48365012.69041467, 48323276.362952106, 48279376.05424808, 48236818.08039121, 48199046.037304215, 48160673.987502724, 48121529.19679745, 48084296.9222826, 48049037.03444613, 48014345.42824394, 47967241.67167476, 47923497.844211906, 47877719.66952568, 47835250.22566369, 47793419.42524596, 47764668.102124035, 47736004.32851524, 47707315.54506275, 47687713.2009239, 47660974.21633419, 47646476.18963799, 47637741.8018214, 47623544.81474975, 47609150.38641171, 47596438.02026322, 47578265.32694816, 47560148.787984, 47542668.17489816, 47524040.2185081, 47506039.66709259, 47483887.83806557, 47462125.86736156, 47436251.66142085, 47420218.45564431, 47395091.81498682, 47367412.46269838, 47340180.78642089, 47316961.810914755, 47296696.01227124, 47274231.20041176, 47256607.682471775, 47228979.30426187, 47201965.965104766, 47175186.613103904, 47155863.832989246, 47137339.2385566, 47117091.06765872, 47099212.36890569, 47079708.22118166, 47062453.38234073, 47037503.09237373, 47012034.85095188, 46983678.62916284, 46959033.56697159, 46933750.0165754, 46919680.425958514, 46903239.95870393, 46889724.73699801, 46873864.38730325, 46860881.933863446, 46837253.051102936, 46822476.54194205, 46807991.232032664, 46792205.279926, 46766651.211495675, 46750516.396643415, 46737034.657743685, 46721397.27687776, 46706913.667956576, 46691321.76845811, 46692535.9532145, 46688202.07328276, 46684183.3105728, 46680046.618732065, 46676207.896392345, 46666740.95167922, 46657922.46718879, 46652597.33481587, 46641018.363311894, 46630098.419399925, 46620161.4239055, 46610431.27042984, 46595128.26064121, 46586964.33848071, 46572094.04728405, 46570759.38276917, 46569566.56741385, 46569024.52372804, 46568101.68472351, 46560040.80369601, 46541022.8966153, 46522305.36046572, 46501768.987065695, 46483492.17143729, 46464317.03912168, 46456622.185413316, 46448697.8573482, 46440445.12329784, 46426338.86567241, 46411791.931085296, 46397302.22798937, 46383027.524727955, 46366900.54265579, 46352998.84823163, 46338493.65407463, 46327092.38370433, 46311241.91641263, 46300200.981600724, 46291710.73430463, 46281535.6225152, 46279700.19528474, 46277052.15072855, 46275375.57164437, 46267944.51291061, 46260654.860183105, 46262165.14551244, 46263772.6808724, 46264350.14889262, 46263811.34218626, 46261048.76980127, 46257137.663144484, 46250500.90735706, 46245948.72797763, 46239620.16739998, 46236256.65567602, 46199796.55588921, 46163794.98606446, 46131218.86588824, 46100134.7482434, 46068392.61609405, 46068072.00159528, 46067825.90058775, 46069451.31891621, 46071311.63582023, 46071268.179737344, 46066962.44336118, 46061127.700160235, 46056128.234846495, 46052903.863520674, 46047423.64358196, 46045461.39150838, 46043583.96146092, 46041789.21022151, 46040075.04125657, 46034028.84991751, 46022845.34899135, 46011849.47648498, 46000405.596140854, 45989780.76861004, 45979333.606324255, 45977919.64499198, 45976574.03609381, 45975295.01913832, 45970245.75772141, 45966188.16278336, 45964726.92442762, 45960128.563412994, 45958861.2800868, 45953854.58401826, 45948734.83676826, 45931404.94035249, 45911536.645040505, 45894681.92850264, 45874780.141768865, 45855654.65949728, 45850971.998374596, 45846313.5942574, 45847233.98093508, 45848243.00871557, 45848631.923120454, 45840343.419358656, 45829875.82285455, 45823626.544884026, 45817438.286349006, 45811419.182604775, 45810513.41834333, 45809019.577130824, 45808207.120124795, 45804292.08334419, 45801069.130494416, 45790749.890854515, 45779022.247124635, 45768961.37417113, 45756894.16404399, 45747182.59054186, 45748936.21115002, 45750708.102640994, 45754796.40829019, 45756602.24260883, 45758423.879684806, 45751511.132975124, 45745504.52081496, 45738918.64613684, 45733225.68052937, 45726952.852141775, 45720462.392486624, 45713709.528140076, 45707494.33903133, 45700903.83888283, 45697651.08792945, 45692412.82739849, 45687262.60822135, 45681598.58721233, 45676020.495194376, 45670526.8909507, 45664572.35275679, 45658850.520147905, 45653070.40396308, 45642782.44050284, 45637321.13421098, 45633594.08638325, 45629964.42355744, 45626104.21441003, 45621472.364029445, 45618960.31897076, 45620898.50153509, 45622190.50202845, 45629320.39288475, 45629277.32285416, 45633070.44991227, 45631124.98187689, 45630369.32107925, 45626963.660245664, 45625833.45577489, 45623965.19312585, 45629099.17679633, 45634228.26440023, 45627031.60891801, 45625550.73765092, 45622325.190536104, 45624277.81954939, 45625789.71696421, 45627323.7032944, 45628878.81991843, 45631714.87340535, 45635148.84802165, 45640599.873068176, 45644879.06576441, 45645017.56177193, 45650749.9860497, 45654695.82515711, 45653537.55367043, 45657402.20407036, 45649600.62309601, 45648610.30837333, 45648071.48732696, 45649397.769163884, 45649292.21580488, 45649821.030286446, 45647686.555893235, 45631352.229002096, 45613875.19596288, 45597985.70142003, 45582225.33664142, 45565793.64586818, 45565874.12310077, 45563846.830926135, 45563991.277315676, 45560538.31238348, 45558638.893116705, 45553290.0352007, 45550525.228195645, 45545241.89497183, 45539666.0857137, 45534217.24956667, 45544358.90336269, 45554430.89218618, 45564433.28317168, 45574366.15467119, 45584229.59531031, 45579119.79145297, 45576144.05348401, 45571056.37764144, 45568089.28881066, 45565173.54977028, 45564941.39253754, 45564839.34136824, 45564934.80761503, 45566771.79921117, 45567363.07782287, 45566099.46481009, 45564870.623567246, 45563675.76653422, 45562514.12221162, 45561384.93534218, 45561284.36808686, 45562558.54818293, 45562778.47274872, 45563735.44945454, 45569432.458395764, 45571284.14849865, 45573087.5219076, 45575300.910568714, 45577514.751453884, 45579348.21514136, 45587554.07546397, 45597103.921391614, 45605207.34249263, 45614651.59081997, 45622651.85667368, 45626255.059837215, 45628012.81689507, 45626695.94225818, 45623299.41784602, 45619961.26835548, 45617228.73466762, 45614558.427197024, 45612887.10288167, 45608133.50083964, 45606628.51006122, 45614049.84980221, 45621440.14367475, 45628964.61723953, 45631686.74934838, 45638461.171472006])])

Making predictions...

Sample predictions:
datetime    instrument
2024-01-01  ^NSEI_RAW_10YRS    13782.782514
2024-01-02  ^NSEI_RAW_10YRS    10147.815272
2024-01-03  ^NSEI_RAW_10YRS    11640.295060
2024-01-04  ^NSEI_RAW_10YRS    11017.923125
2024-01-05  ^NSEI_RAW_10YRS    11428.206914
dtype: float64
[8796:MainThread](2025-05-09 16:47:22,393) INFO - qlib.timer - [log.py:127] - Time cost: 2.002s | waiting `async_log` Done
Model saved in LightGBM format at: E:\Finance Internship\TASK_5\NSEI\train-test\models\20250509_164706\model.txt
Config saved at: E:\Finance Internship\TASK_5\NSEI\train-test\models\20250509_164706\config.json

-------------------------- Metric --------------------------
MSE:                      106053970.7739
RMSE:                         10298.2509
MAE:                          10087.9235
R²:                             -63.6937
Correlation:                      0.0295
Direction Accuracy:               52.85%
[8796:MainThread](2025-05-09 16:49:54,597) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[AttributeError: 'CustomHandler' object has no attribute 'input_cols'].
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 507, in <module>
    main()
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 339, in main
    evaluate_model(model, dataset, evals_result)
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 429, in evaluate_model
    feature_names = dataset.handler.input_cols  # Correct way to get feature names
AttributeError: 'CustomHandler' object has no attribute 'input_cols'











######################################################################################################################################











(qlib_env) PS E:\Finance Internship\TASK_5\NSEI> python .\model_raw.py
[12900:MainThread](2025-05-09 16:37:02,753) INFO - qlib.Initialization - [config.py:420] - default_conf: client.
[12900:MainThread](2025-05-09 16:37:02,760) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[12900:MainThread](2025-05-09 16:37:02,762) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': WindowsPath('C:/Users/ASUS/.qlib/qlib_data/NSEI_raw_10yrs')}
Raw data shape: (1895, 5)
Raw data NaN count per column:
$open      0
$high      0
$low       0
$close     0
$volume    0
dtype: int64
                                  $open        $high         $low       $close   $volume
instrument      datetime
^NSEI_RAW_10YRS 2015-04-24  8405.700195  8413.299805  8273.349609  8305.250000  173600.0
                2015-04-27  8330.549805  8334.450195  8202.349609  8213.799805  171500.0
                2015-04-28  8215.549805  8308.000000  8185.149902  8285.599609  174600.0
                2015-04-29  8274.799805  8308.200195  8219.200195  8239.750000  160400.0
                2015-04-30  8224.500000  8229.400391  8144.750000  8181.500000  267700.0

Available instruments: {'market': 'all', 'filter_pipe': []}
Final feature expressions: ['($close - Ref($close, 1)) / Ref($close, 1)', 'Std($close, 5)', '($volume - Ref($volume, 1)) / Ref($volume, 1)']
Feature names: ['returns_(close-Ref(', 'volatility_Std(close,5)', 'volume_change_(volume-Ref(']
[12900:MainThread](2025-05-09 16:37:07,303) INFO - qlib.timer - [log.py:127] - Time cost: 0.043s | Init data Done

Dataset information:
Training data shapes:
('feature', 'returns_(close-Ref(') shape: (1895,)
('feature', 'volatility_Std(close,5)') shape: (1895,)
('feature', 'volume_change_(volume-Ref(') shape: (1895,)
('label', 'NEXT_CLOSE') shape: (1895,)

Available columns in the dataset:
MultiIndex([('feature',        'returns_(close-Ref('),
            ('feature',    'volatility_Std(close,5)'),
            ('feature', 'volume_change_(volume-Ref('),
            (  'label',                 'NEXT_CLOSE')],
           )
Train data after processing: (1895, 4)
                                       feature  ...        label
                           returns_(close-Ref(  ...   NEXT_CLOSE
datetime   instrument                           ...
2015-04-24 ^NSEI_RAW_10YRS                 NaN  ...  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011  ...  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741  ...  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534  ...  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069  ...  8331.950195

[5 rows x 4 columns]

NaN count per column:
feature  returns_(close-Ref(           1
         volatility_Std(close,5)       1
         volume_change_(volume-Ref(    2
label    NEXT_CLOSE                    0
dtype: int64

Rows with all NaN values:
Empty DataFrame
Columns: [(feature, returns_(close-Ref(), (feature, volatility_Std(close,5)), (feature, volume_change_(volume-Ref(), (label, NEXT_CLOSE)]   
Index: []

Rows with at least one non-NaN value:
                                       feature  ...        label
                           returns_(close-Ref(  ...   NEXT_CLOSE
datetime   instrument                           ...
2015-04-24 ^NSEI_RAW_10YRS                 NaN  ...  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011  ...  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741  ...  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534  ...  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069  ...  8331.950195

[5 rows x 4 columns]

Feature Correlations:
Highly correlated features:

Do you want to proceed with training? (y/n): y
[12900:MainThread](2025-05-09 16:37:17,766) INFO - qlib.workflow - [exp.py:258] - Experiment 208382467731689026 starts running ...
[12900:MainThread](2025-05-09 16:37:18,103) INFO - qlib.workflow - [recorder.py:345] - Recorder 43693ffaef06491aa0d6abfa13b7fb9f starts running under Experiment 208382467731689026 ...

Training model...
Training until validation scores don't improve for 50 rounds
[20]    train's l2: 9.63014e+06 valid's l2: 5.11764e+07
[40]    train's l2: 8.83452e+06 valid's l2: 4.97801e+07
[60]    train's l2: 8.26188e+06 valid's l2: 4.87656e+07
[80]    train's l2: 7.84772e+06 valid's l2: 4.80143e+07
[100]   train's l2: 7.52574e+06 valid's l2: 4.7506e+07
[120]   train's l2: 7.28527e+06 valid's l2: 4.70625e+07
[140]   train's l2: 7.0791e+06  valid's l2: 4.66913e+07
[160]   train's l2: 6.90239e+06 valid's l2: 4.656e+07
[180]   train's l2: 6.77216e+06 valid's l2: 4.62815e+07
[200]   train's l2: 6.64409e+06 valid's l2: 4.60684e+07
[220]   train's l2: 6.55482e+06 valid's l2: 4.59793e+07
[240]   train's l2: 6.4485e+06  valid's l2: 4.58486e+07
[260]   train's l2: 6.37203e+06 valid's l2: 4.57584e+07
[280]   train's l2: 6.29472e+06 valid's l2: 4.56373e+07
[300]   train's l2: 6.22942e+06 valid's l2: 4.56223e+07
[320]   train's l2: 6.17362e+06 valid's l2: 4.56477e+07
[340]   train's l2: 6.12026e+06 valid's l2: 4.55842e+07
[360]   train's l2: 6.0724e+06  valid's l2: 4.55694e+07
[380]   train's l2: 6.02333e+06 valid's l2: 4.56066e+07
Early stopping, best iteration is:
[335]   train's l2: 6.13266e+06 valid's l2: 4.55342e+07

Training Metrics:
train: OrderedDict([('l2', [10699600.158484442, 10633331.2495526, 10569109.950164096, 10505142.432186686, 10442537.269416708, 10381999.05221954, 10322622.558123603, 10264514.125469605, 10207697.089352207, 10150287.085507678, 10093469.10181894, 10037642.217206521, 9983101.056414833, 9929654.339120904, 9877475.826827662, 9826188.735784244, 9775820.902471358, 9726055.11160674, 9677775.632459188, 9630143.446310427, 9585546.775037635, 9541843.529606724, 9497953.608512126, 9455596.94656511, 9414314.511479465, 9370618.164252974, 9327808.734489165, 9285868.40853311, 9244779.729131918, 9204558.38461805, 9164279.929709861, 9125188.682249434, 9086902.922136975, 9048965.46857426, 9012189.103564283, 8975229.154728185, 8938993.479738517, 8903463.673329994, 8868668.440205473, 8834518.761983152, 8801053.943432638, 8768188.807818366, 8736078.48916626, 8704571.710935885, 8673760.716333203, 8642725.312955039, 8612877.18226933, 8583463.38286612, 8554175.617471604, 8526136.515412655, 8497727.172419671, 8469873.591500008, 8442545.063820463, 8416304.702667855, 8389774.56768782, 8363245.695596023, 8337046.119326575, 8311999.097883654, 8286707.452427342, 8261883.310615587, 8237067.34603691, 8212810.378629315, 8189161.341984027, 8165931.685399131, 8143230.511115198, 8121425.667840032, 8100088.083623974, 8079173.830308321, 8058705.6172979465, 8038639.196338175, 8018478.66248476, 7998335.979001325, 7978137.369171016, 7958773.47415949, 7939739.274286641, 7920458.618604857, 7901753.09956528, 7883215.031511822, 7865282.848407742, 7847723.541862798, 7830467.423372642, 7812940.042725233, 7796380.281787239, 7779546.836277843, 7763665.883859372, 7746299.179267759, 7729192.107447326, 7712090.145061841, 7694871.105796582, 7678831.060370659, 7661557.878680661, 7644766.903320994, 7628509.464077427, 7612194.509112312, 7596744.7879331475, 7581870.127764323, 7567321.138544995, 7553059.719878059, 7539262.738502567, 7525738.222341838, 7511878.094456677, 7498309.51640095, 7484854.313634333, 7471701.625648219, 7458752.79256065, 7445159.875926154, 7431852.057868841, 7418508.744919236, 7405417.682720897, 7392704.963660491, 7381278.518240873, 7370063.808364399, 7359084.139153642, 7348332.044878572, 7337812.107660628, 7327046.359514276, 7316065.398109987, 7305725.935016779, 7295198.323737533, 7285267.994116156, 7272916.909200392, 7260764.5710398005, 7249010.291124305, 7237363.987533074, 7226175.069343732, 7215174.182625108, 7204343.698336096, 7193805.324384839, 7183427.783267442, 7173333.152729705, 7163881.3162736, 7153173.246816697, 7142695.344895052, 7132413.064394695, 7122916.49973363, 7113842.067810103, 7104877.98533715, 7096153.363139457, 7087612.47103402, 7079096.938779095, 7070830.075677799, 7061912.466224057, 7054197.737318658, 7045559.428066909, 7038102.301594928, 7028051.540693279, 7018257.867357494, 7009306.272426338, 6999677.518131344, 6990299.55977275, 6982249.731388006, 6974378.48996151, 6965423.318439948, 6957822.726948083, 6949179.280512642, 6939507.140795784, 6930047.295988422, 6920794.657249754, 6911745.097536577, 6902387.981888065, 6894759.417923842, 6887301.040438195, 6879968.168131771, 6872826.788221299, 6865613.745298194, 6858198.402614111, 6851142.950001324, 6844336.353742508, 6837675.294304914, 6831175.799493703, 6824922.516977996, 6818806.100128802, 6811866.470770004, 6805957.833717256, 6799884.721039065, 6794208.511450749, 6788335.563089769, 6782888.187305658, 6777421.526543579, 6772159.013897007, 6765518.624577993, 6759042.910480699, 6752690.43164596, 6746186.26835785, 6739825.203938326, 6732811.563915944, 6725964.010113207, 6719365.454227125, 6713139.240200923, 6706596.340367615, 6699987.961904459, 6692980.901564028, 6687200.991639962, 6680485.973600874, 6674414.280201093, 6668087.315792494, 6661897.476784499, 6655959.230496306, 6650372.950706432, 6644091.411425955, 6638863.071573501, 6633756.2655787505, 6628655.294742916, 6623680.213094584, 6618917.276734608, 6614349.801239267, 6610037.725271151, 6605726.119886373, 6601729.050599554, 6597673.464748224, 6592955.92324143, 6588345.660204992, 6583840.4083629735, 6579437.946795745, 6575136.328368121, 6570870.10003463, 6566705.418771122, 6562669.724446483, 6558699.351181608, 6554824.154665261, 6550556.9637165675, 6546386.216076019, 6542309.878682065, 6538279.313506881, 6534146.057306933, 6528513.079540238, 6522144.063339142, 6516722.261658936, 6510509.887602375, 6504458.314075085, 6499279.612841153, 6494103.828509439, 6489147.194081698, 6484718.832985285, 6479852.282039134, 6473017.080075016, 6466289.255003182, 6460059.547892395, 6453979.910059383, 6448495.732406606, 6444633.115379333, 6440894.902595415, 6436941.310891867, 6433086.301446749, 6429303.390268537, 6426017.483599896, 6422803.748485127, 6419660.681988179, 6416164.882726186, 6412745.809950661, 6407431.43217614, 6402194.614376732, 6397231.988040589, 6392217.903628895, 6387470.236277922, 6384242.734033922, 6381086.825797167, 6378017.472178026, 6374991.147345582, 6372032.205445787, 6366190.206171675, 6360461.65831737, 6354882.4497440765, 6349409.207096396, 6344077.471215495, 6339979.249383547, 6336044.999401964, 6332146.086992244, 6328383.49450053, 6324839.445957821, 6322497.028224604, 6320207.216801563, 6317977.652849318, 6315798.310524168, 6313668.132735507, 6309854.953907828, 6306078.363775199, 6302368.00401771, 6298374.580964158, 6294723.197195155, 6291378.984249474, 6288115.390799467, 6284866.918699738, 6281689.31418334, 6278657.315010612, 6274016.976972173, 6269502.817305771, 6265448.566004571, 6261124.398789023, 6256805.676835811, 6255090.399772838, 6252197.12398829, 6248716.443314584, 6246337.427332905, 6244694.501882904, 6241402.13991623, 6238185.644161756, 6234893.282613091, 6232769.233936744, 6229416.140203772, 6227007.192830653, 6224636.218324373, 6222326.964514935, 6220078.058888251, 6216982.08590513, 6215045.866016312, 6213698.887667848, 6211740.048615784, 6208974.533800091, 6206356.350800069, 6202657.6506005665, 6198904.773808114, 6195954.731537001, 6191940.4646626655, 6188376.47062618, 6185666.632573152, 6182298.373048264, 6179055.687784687, 6175893.645924384, 6173620.779718015, 6169663.940607253, 6165816.006227849, 6162037.657698666, 6158350.096044052, 6154692.482676655, 6152968.536388997, 6151722.873419016, 6150056.542934931, 6149071.864060216, 6147893.19268912, 6144624.865548329, 6141342.79307789, 6138379.827658664, 6135484.0509557985, 6132656.227489423, 6130056.2557022115, 6127517.775493663, 6125039.466728687, 6122620.036424048, 6120258.218344637, 6116929.354449827, 6115199.433014075, 6111898.081809935, 6110486.232769784, 6109109.5263395, 6107044.267622977, 6104992.516689767, 6103102.37332257, 6101368.137445907, 6099511.8223706065, 6097979.211003119, 6096482.653185017, 6095021.376424787, 6093594.624108066, 6092201.655219758, 6087435.697308627, 6083124.976619272, 6078927.247016445, 6074872.085681367, 6072397.626039703, 6070423.028543899, 6068490.999578642, 6066774.510360597, 6065098.136143308, 6063272.009136806, 6060377.629259341, 6057103.585504688, 6054329.1223873915, 6051182.653754042, 6048523.258621891, 6046367.508511582, 6044256.322398064, 6042236.896054202, 6040210.074929925, 6038230.706869752, 6035308.318321127, 6032453.083393174, 6029527.078576496, 6026477.612747291, 6023333.99328134, 6020618.167479434, 6017972.835948429, 6015401.991223537, 6012788.337274603, 6010335.466450195])])
valid: OrderedDict([('l2', [53124293.895417936, 53022060.778796695, 52916970.39798651, 52820566.57335308, 52723548.23416552, 52597448.480167106, 52474681.21732355, 52352617.98722755, 52245101.57632615, 52129230.9240378, 52023135.87841521, 51917833.1159649, 51815161.19147513, 51715006.97474483, 51612061.16505968, 51523314.018073216, 51435243.49774776, 51345727.12881613, 51260941.50583827, 51176375.095062844, 51107741.384508, 51040312.30394841, 50968500.73790903, 50900197.575841054, 50824648.773127824, 50736287.4169774, 50649375.24475019, 50563886.517726734, 50479795.97710573, 50402632.20553151, 50340239.01572228, 50275293.26475293, 50211442.098349065, 50153252.55405822, 50092042.55679953, 50028526.68266696, 49961819.62769496, 49900324.10356763, 49837306.07205098, 49780129.30071595, 49727393.60027293, 49675944.80714634, 49625009.27819131, 49575693.15201122, 49526488.59041471, 49467939.841432944, 49405636.68905121, 49353375.304297246, 49296635.55277811, 49242205.71446729, 49190861.25493708, 49138196.18117475, 49085222.4631424, 49038385.6762817, 48989384.31025925, 48945483.900033146, 48898437.421678066, 48855754.69905732, 48812125.36593301, 48765558.84232551, 48713072.87102874, 48662020.64059363, 48615941.628205135, 48570942.77094148, 48526244.3427065, 48501977.153162025, 48477524.82452827, 48454249.09580631, 48430549.17965573, 48408230.475090034, 48365012.69041467, 48323276.362952106, 48279376.05424808, 48236818.08039121, 48199046.037304215, 48160673.987502724, 48121529.19679745, 48084296.9222826, 48049037.03444613, 48014345.42824394, 47967241.67167476, 47923497.844211906, 47877719.66952568, 47835250.22566369, 47793419.42524596, 47764668.102124035, 47736004.32851524, 47707315.54506275, 47687713.2009239, 47660974.21633419, 47646476.18963799, 47637741.8018214, 47623544.81474975, 47609150.38641171, 47596438.02026322, 47578265.32694816, 47560148.787984, 47542668.17489816, 47524040.2185081, 47506039.66709259, 47483887.83806557, 47462125.86736156, 47436251.66142085, 47420218.45564431, 47395091.81498682, 47367412.46269838, 47340180.78642089, 47316961.810914755, 47296696.01227124, 47274231.20041176, 47256607.682471775, 47228979.30426187, 47201965.965104766, 47175186.613103904, 47155863.832989246, 47137339.2385566, 47117091.06765872, 47099212.36890569, 47079708.22118166, 47062453.38234073, 47037503.09237373, 47012034.85095188, 46983678.62916284, 46959033.56697159, 46933750.0165754, 46919680.425958514, 46903239.95870393, 46889724.73699801, 46873864.38730325, 46860881.933863446, 46837253.051102936, 46822476.54194205, 46807991.232032664, 46792205.279926, 46766651.211495675, 46750516.396643415, 46737034.657743685, 46721397.27687776, 46706913.667956576, 46691321.76845811, 46692535.9532145, 46688202.07328276, 46684183.3105728, 46680046.618732065, 46676207.896392345, 46666740.95167922, 46657922.46718879, 46652597.33481587, 46641018.363311894, 46630098.419399925, 46620161.4239055, 46610431.27042984, 46595128.26064121, 46586964.33848071, 46572094.04728405, 46570759.38276917, 46569566.56741385, 46569024.52372804, 46568101.68472351, 46560040.80369601, 46541022.8966153, 46522305.36046572, 46501768.987065695, 46483492.17143729, 46464317.03912168, 46456622.185413316, 46448697.8573482, 46440445.12329784, 46426338.86567241, 46411791.931085296, 46397302.22798937, 46383027.524727955, 46366900.54265579, 46352998.84823163, 46338493.65407463, 46327092.38370433, 46311241.91641263, 46300200.981600724, 46291710.73430463, 46281535.6225152, 46279700.19528474, 46277052.15072855, 46275375.57164437, 46267944.51291061, 46260654.860183105, 46262165.14551244, 46263772.6808724, 46264350.14889262, 46263811.34218626, 46261048.76980127, 46257137.663144484, 46250500.90735706, 46245948.72797763, 46239620.16739998, 46236256.65567602, 46199796.55588921, 46163794.98606446, 46131218.86588824, 46100134.7482434, 46068392.61609405, 46068072.00159528, 46067825.90058775, 46069451.31891621, 46071311.63582023, 46071268.179737344, 46066962.44336118, 46061127.700160235, 46056128.234846495, 46052903.863520674, 46047423.64358196, 46045461.39150838, 46043583.96146092, 46041789.21022151, 46040075.04125657, 46034028.84991751, 46022845.34899135, 46011849.47648498, 46000405.596140854, 45989780.76861004, 45979333.606324255, 45977919.64499198, 45976574.03609381, 45975295.01913832, 45970245.75772141, 45966188.16278336, 45964726.92442762, 45960128.563412994, 45958861.2800868, 45953854.58401826, 45948734.83676826, 45931404.94035249, 45911536.645040505, 45894681.92850264, 45874780.141768865, 45855654.65949728, 45850971.998374596, 45846313.5942574, 45847233.98093508, 45848243.00871557, 45848631.923120454, 45840343.419358656, 45829875.82285455, 45823626.544884026, 45817438.286349006, 45811419.182604775, 45810513.41834333, 45809019.577130824, 45808207.120124795, 45804292.08334419, 45801069.130494416, 45790749.890854515, 45779022.247124635, 45768961.37417113, 45756894.16404399, 45747182.59054186, 45748936.21115002, 45750708.102640994, 45754796.40829019, 45756602.24260883, 45758423.879684806, 45751511.132975124, 45745504.52081496, 45738918.64613684, 45733225.68052937, 45726952.852141775, 45720462.392486624, 45713709.528140076, 45707494.33903133, 45700903.83888283, 45697651.08792945, 45692412.82739849, 45687262.60822135, 45681598.58721233, 45676020.495194376, 45670526.8909507, 45664572.35275679, 45658850.520147905, 45653070.40396308, 45642782.44050284, 45637321.13421098, 45633594.08638325, 45629964.42355744, 45626104.21441003, 45621472.364029445, 45618960.31897076, 45620898.50153509, 45622190.50202845, 45629320.39288475, 45629277.32285416, 45633070.44991227, 45631124.98187689, 45630369.32107925, 45626963.660245664, 45625833.45577489, 45623965.19312585, 45629099.17679633, 45634228.26440023, 45627031.60891801, 45625550.73765092, 45622325.190536104, 45624277.81954939, 45625789.71696421, 45627323.7032944, 45628878.81991843, 45631714.87340535, 45635148.84802165, 45640599.873068176, 45644879.06576441, 45645017.56177193, 45650749.9860497, 45654695.82515711, 45653537.55367043, 45657402.20407036, 45649600.62309601, 45648610.30837333, 45648071.48732696, 45649397.769163884, 45649292.21580488, 45649821.030286446, 45647686.555893235, 45631352.229002096, 45613875.19596288, 45597985.70142003, 45582225.33664142, 45565793.64586818, 45565874.12310077, 45563846.830926135, 45563991.277315676, 45560538.31238348, 45558638.893116705, 45553290.0352007, 45550525.228195645, 45545241.89497183, 45539666.0857137, 45534217.24956667, 45544358.90336269, 45554430.89218618, 45564433.28317168, 45574366.15467119, 45584229.59531031, 45579119.79145297, 45576144.05348401, 45571056.37764144, 45568089.28881066, 45565173.54977028, 45564941.39253754, 45564839.34136824, 45564934.80761503, 45566771.79921117, 45567363.07782287, 45566099.46481009, 45564870.623567246, 45563675.76653422, 45562514.12221162, 45561384.93534218, 45561284.36808686, 45562558.54818293, 45562778.47274872, 45563735.44945454, 45569432.458395764, 45571284.14849865, 45573087.5219076, 45575300.910568714, 45577514.751453884, 45579348.21514136, 45587554.07546397, 45597103.921391614, 45605207.34249263, 45614651.59081997, 45622651.85667368, 45626255.059837215, 45628012.81689507, 45626695.94225818, 45623299.41784602, 45619961.26835548, 45617228.73466762, 45614558.427197024, 45612887.10288167, 45608133.50083964, 45606628.51006122, 45614049.84980221, 45621440.14367475, 45628964.61723953, 45631686.74934838, 45638461.171472006])])

Making predictions...

Sample predictions:
datetime    instrument
2024-01-01  ^NSEI_RAW_10YRS    13782.782514
2024-01-02  ^NSEI_RAW_10YRS    10147.815272
2024-01-03  ^NSEI_RAW_10YRS    11640.295060
2024-01-04  ^NSEI_RAW_10YRS    11017.923125
2024-01-05  ^NSEI_RAW_10YRS    11428.206914
dtype: float64
[12900:MainThread](2025-05-09 16:37:21,242) INFO - qlib.timer - [log.py:127] - Time cost: 1.985s | waiting `async_log` Done

-------------------------- Metric --------------------------
MSE:                      106053970.7739
RMSE:                         10298.2509
MAE:                          10087.9235
R²:                             -63.6937
Correlation:                      0.0295
Direction Accuracy:               52.85%
[12900:MainThread](2025-05-09 16:37:44,577) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[AttributeError: 'DatasetH' object has no attribute 'feature_names'].
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 489, in <module>
    main()
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 339, in main
    evaluate_model(model, dataset, evals_result)
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 436, in evaluate_model
    'feature': dataset.feature_names,
AttributeError: 'DatasetH' object has no attribute 'feature_names'












######################################################################################################################################











(qlib_env) PS E:\Finance Internship\TASK_5\NSEI> python .\model_raw.py
[17840:MainThread](2025-05-09 16:31:58,124) INFO - qlib.Initialization - [config.py:420] - default_conf: client.
[17840:MainThread](2025-05-09 16:31:58,124) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[17840:MainThread](2025-05-09 16:31:58,124) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': WindowsPath('C:/Users/ASUS/.qlib/qlib_data/NSEI_raw_10yrs')}
Raw data shape: (1895, 5)
Raw data NaN count per column:
$open      0
$high      0
$low       0
$close     0
$volume    0
dtype: int64
                                  $open        $high         $low       $close   $volume
instrument      datetime
^NSEI_RAW_10YRS 2015-04-24  8405.700195  8413.299805  8273.349609  8305.250000  173600.0
                2015-04-27  8330.549805  8334.450195  8202.349609  8213.799805  171500.0
                2015-04-28  8215.549805  8308.000000  8185.149902  8285.599609  174600.0
                2015-04-29  8274.799805  8308.200195  8219.200195  8239.750000  160400.0
                2015-04-30  8224.500000  8229.400391  8144.750000  8181.500000  267700.0

Available instruments: {'market': 'all', 'filter_pipe': []}
Final feature expressions: ['($close - Ref($close, 1)) / Ref($close, 1)', 'Std($close, 5)', '($volume - Ref($volume, 1)) / Ref($volume, 1)']
Feature names: ['returns_(close-Ref(', 'volatility_Std(close,5)', 'volume_change_(volume-Ref(']
[17840:MainThread](2025-05-09 16:32:01,290) INFO - qlib.timer - [log.py:127] - Time cost: 0.020s | Loading data Done
[17840:MainThread](2025-05-09 16:32:01,290) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | fit & process data Done
[17840:MainThread](2025-05-09 16:32:01,292) INFO - qlib.timer - [log.py:127] - Time cost: 0.022s | Init data Done

Dataset information:
Training data shapes:
('feature', 'returns_(close-Ref(') shape: (1895,)
('feature', 'volatility_Std(close,5)') shape: (1895,)
('feature', 'volume_change_(volume-Ref(') shape: (1895,)
('label', 'NEXT_CLOSE') shape: (1895,)

Available columns in the dataset:
MultiIndex([('feature',        'returns_(close-Ref('),
            ('feature',    'volatility_Std(close,5)'),
            ('feature', 'volume_change_(volume-Ref('),
            (  'label',                 'NEXT_CLOSE')],
           )
Train data after processing: (1895, 4)
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

NaN count per column:
feature  returns_(close-Ref(           1
         volatility_Std(close,5)       1
         volume_change_(volume-Ref(    2
label    NEXT_CLOSE                    0
dtype: int64

Rows with all NaN values:
Empty DataFrame
Columns: [(feature, returns_(close-Ref(), (feature, volatility_Std(close,5)), (feature, volume_change_(volume-Ref(), (label, NEXT_CLOSE)]
Index: []

Rows with at least one non-NaN value:
                                       feature                                                           label
                           returns_(close-Ref( volatility_Std(close,5) volume_change_(volume-Ref(   NEXT_CLOSE
datetime   instrument
2015-04-24 ^NSEI_RAW_10YRS                 NaN                     NaN                        NaN  8213.799805
2015-04-27 ^NSEI_RAW_10YRS           -0.011011               64.665054                  -0.012097  8285.599609
2015-04-28 ^NSEI_RAW_10YRS            0.008741               48.139534                   0.018076  8239.750000
2015-04-29 ^NSEI_RAW_10YRS           -0.005534               41.803448                  -0.081329  8181.500000
2015-04-30 ^NSEI_RAW_10YRS           -0.007069               50.772762                   0.668953  8331.950195

Feature Correlations:
Highly correlated features:

Do you want to proceed with training? (y/n): y
[17840:MainThread](2025-05-09 16:32:31,079) INFO - qlib.workflow - [exp.py:258] - Experiment 208382467731689026 starts running ...
[17840:MainThread](2025-05-09 16:32:31,433) INFO - qlib.workflow - [recorder.py:345] - Recorder e241c979a2894344937dfee42f4af62b starts running under Experiment 208382467731689026 ...

Training model...
Training until validation scores don't improve for 50 rounds
[20]    train's l2: 9.63014e+06 valid's l2: 5.11764e+07
[40]    train's l2: 8.83452e+06 valid's l2: 4.97801e+07
[60]    train's l2: 8.26188e+06 valid's l2: 4.87656e+07
[80]    train's l2: 7.84772e+06 valid's l2: 4.80143e+07
[100]   train's l2: 7.52574e+06 valid's l2: 4.7506e+07
[120]   train's l2: 7.28527e+06 valid's l2: 4.70625e+07
[140]   train's l2: 7.0791e+06  valid's l2: 4.66913e+07
[160]   train's l2: 6.90239e+06 valid's l2: 4.656e+07
[180]   train's l2: 6.77216e+06 valid's l2: 4.62815e+07
[200]   train's l2: 6.64409e+06 valid's l2: 4.60684e+07
[220]   train's l2: 6.55482e+06 valid's l2: 4.59793e+07
[240]   train's l2: 6.4485e+06  valid's l2: 4.58486e+07
[260]   train's l2: 6.37203e+06 valid's l2: 4.57584e+07
[280]   train's l2: 6.29472e+06 valid's l2: 4.56373e+07
[300]   train's l2: 6.22942e+06 valid's l2: 4.56223e+07
[320]   train's l2: 6.17362e+06 valid's l2: 4.56477e+07
[340]   train's l2: 6.12026e+06 valid's l2: 4.55842e+07
[360]   train's l2: 6.0724e+06  valid's l2: 4.55694e+07
[380]   train's l2: 6.02333e+06 valid's l2: 4.56066e+07
Early stopping, best iteration is:
[335]   train's l2: 6.13266e+06 valid's l2: 4.55342e+07

Training Metrics:
train: OrderedDict([('l2', [10699600.158484442, 10633331.2495526, 10569109.950164096, 10505142.432186686, 10442537.269416708, 10381999.05221954, 10322622.558123603, 10264514.125469605, 10207697.089352207, 10150287.085507678, 10093469.10181894, 10037642.217206521, 9983101.056414833, 9929654.339120904, 9877475.826827662, 9826188.735784244, 9775820.902471358, 9726055.11160674, 9677775.632459188, 9630143.446310427, 9585546.775037635, 9541843.529606724, 9497953.608512126, 9455596.94656511, 9414314.511479465, 9370618.164252974, 9327808.734489165, 9285868.40853311, 9244779.729131918, 9204558.38461805, 9164279.929709861, 9125188.682249434, 9086902.922136975, 9048965.46857426, 9012189.103564283, 8975229.154728185, 8938993.479738517, 8903463.673329994, 8868668.440205473, 8834518.761983152, 8801053.943432638, 8768188.807818366, 8736078.48916626, 8704571.710935885, 8673760.716333203, 8642725.312955039, 8612877.18226933, 8583463.38286612, 8554175.617471604, 8526136.515412655, 8497727.172419671, 8469873.591500008, 8442545.063820463, 8416304.702667855, 8389774.56768782, 8363245.695596023, 8337046.119326575, 8311999.097883654, 8286707.452427342, 8261883.310615587, 8237067.34603691, 8212810.378629315, 8189161.341984027, 8165931.685399131, 8143230.511115198, 8121425.667840032, 8100088.083623974, 8079173.830308321, 8058705.6172979465, 8038639.196338175, 8018478.66248476, 7998335.979001325, 7978137.369171016, 7958773.47415949, 7939739.274286641, 7920458.618604857, 7901753.09956528, 7883215.031511822, 7865282.848407742, 7847723.541862798, 7830467.423372642, 7812940.042725233, 7796380.281787239, 7779546.836277843, 7763665.883859372, 7746299.179267759, 7729192.107447326, 7712090.145061841, 7694871.105796582, 7678831.060370659, 7661557.878680661, 7644766.903320994, 7628509.464077427, 7612194.509112312, 7596744.7879331475, 7581870.127764323, 7567321.138544995, 7553059.719878059, 7539262.738502567, 7525738.222341838, 7511878.094456677, 7498309.51640095, 7484854.313634333, 7471701.625648219, 7458752.79256065, 7445159.875926154, 7431852.057868841, 7418508.744919236, 7405417.682720897, 7392704.963660491, 7381278.518240873, 7370063.808364399, 7359084.139153642, 7348332.044878572, 7337812.107660628, 7327046.359514276, 7316065.398109987, 7305725.935016779, 7295198.323737533, 7285267.994116156, 7272916.909200392, 7260764.5710398005, 7249010.291124305, 7237363.987533074, 7226175.069343732, 7215174.182625108, 7204343.698336096, 7193805.324384839, 7183427.783267442, 7173333.152729705, 7163881.3162736, 7153173.246816697, 7142695.344895052, 7132413.064394695, 7122916.49973363, 7113842.067810103, 7104877.98533715, 7096153.363139457, 7087612.47103402, 7079096.938779095, 7070830.075677799, 7061912.466224057, 7054197.737318658, 7045559.428066909, 7038102.301594928, 7028051.540693279, 7018257.867357494, 7009306.272426338, 6999677.518131344, 6990299.55977275, 6982249.731388006, 6974378.48996151, 6965423.318439948, 6957822.726948083, 6949179.280512642, 6939507.140795784, 6930047.295988422, 6920794.657249754, 6911745.097536577, 6902387.981888065, 6894759.417923842, 6887301.040438195, 6879968.168131771, 6872826.788221299, 6865613.745298194, 6858198.402614111, 6851142.950001324, 6844336.353742508, 6837675.294304914, 6831175.799493703, 6824922.516977996, 6818806.100128802, 6811866.470770004, 6805957.833717256, 6799884.721039065, 6794208.511450749, 6788335.563089769, 6782888.187305658, 6777421.526543579, 6772159.013897007, 6765518.624577993, 6759042.910480699, 6752690.43164596, 6746186.26835785, 6739825.203938326, 6732811.563915944, 6725964.010113207, 6719365.454227125, 6713139.240200923, 6706596.340367615, 6699987.961904459, 6692980.901564028, 6687200.991639962, 6680485.973600874, 6674414.280201093, 6668087.315792494, 6661897.476784499, 6655959.230496306, 6650372.950706432, 6644091.411425955, 6638863.071573501, 6633756.2655787505, 6628655.294742916, 6623680.213094584, 6618917.276734608, 6614349.801239267, 6610037.725271151, 6605726.119886373, 6601729.050599554, 6597673.464748224, 6592955.92324143, 6588345.660204992, 6583840.4083629735, 6579437.946795745, 6575136.328368121, 6570870.10003463, 6566705.418771122, 6562669.724446483, 6558699.351181608, 6554824.154665261, 6550556.9637165675, 6546386.216076019, 6542309.878682065, 6538279.313506881, 6534146.057306933, 6528513.079540238, 6522144.063339142, 6516722.261658936, 6510509.887602375, 6504458.314075085, 6499279.612841153, 6494103.828509439, 6489147.194081698, 6484718.832985285, 6479852.282039134, 6473017.080075016, 6466289.255003182, 6460059.547892395, 6453979.910059383, 6448495.732406606, 6444633.115379333, 6440894.902595415, 6436941.310891867, 6433086.301446749, 6429303.390268537, 6426017.483599896, 6422803.748485127, 6419660.681988179, 6416164.882726186, 6412745.809950661, 6407431.43217614, 6402194.614376732, 6397231.988040589, 6392217.903628895, 6387470.236277922, 6384242.734033922, 6381086.825797167, 6378017.472178026, 6374991.147345582, 6372032.205445787, 6366190.206171675, 6360461.65831737, 6354882.4497440765, 6349409.207096396, 6344077.471215495, 6339979.249383547, 6336044.999401964, 6332146.086992244, 6328383.49450053, 6324839.445957821, 6322497.028224604, 6320207.216801563, 6317977.652849318, 6315798.310524168, 6313668.132735507, 6309854.953907828, 6306078.363775199, 6302368.00401771, 6298374.580964158, 6294723.197195155, 6291378.984249474, 6288115.390799467, 6284866.918699738, 6281689.31418334, 6278657.315010612, 6274016.976972173, 6269502.817305771, 6265448.566004571, 6261124.398789023, 6256805.676835811, 6255090.399772838, 6252197.12398829, 6248716.443314584, 6246337.427332905, 6244694.501882904, 6241402.13991623, 6238185.644161756, 6234893.282613091, 6232769.233936744, 6229416.140203772, 6227007.192830653, 6224636.218324373, 6222326.964514935, 6220078.058888251, 6216982.08590513, 6215045.866016312, 6213698.887667848, 6211740.048615784, 6208974.533800091, 6206356.350800069, 6202657.6506005665, 6198904.773808114, 6195954.731537001, 6191940.4646626655, 6188376.47062618, 6185666.632573152, 6182298.373048264, 6179055.687784687, 6175893.645924384, 6173620.779718015, 6169663.940607253, 6165816.006227849, 6162037.657698666, 6158350.096044052, 6154692.482676655, 6152968.536388997, 6151722.873419016, 6150056.542934931, 6149071.864060216, 6147893.19268912, 6144624.865548329, 6141342.79307789, 6138379.827658664, 6135484.0509557985, 6132656.227489423, 6130056.2557022115, 6127517.775493663, 6125039.466728687, 6122620.036424048, 6120258.218344637, 6116929.354449827, 6115199.433014075, 6111898.081809935, 6110486.232769784, 6109109.5263395, 6107044.267622977, 6104992.516689767, 6103102.37332257, 6101368.137445907, 6099511.8223706065, 6097979.211003119, 6096482.653185017, 6095021.376424787, 6093594.624108066, 6092201.655219758, 6087435.697308627, 6083124.976619272, 6078927.247016445, 6074872.085681367, 6072397.626039703, 6070423.028543899, 6068490.999578642, 6066774.510360597, 6065098.136143308, 6063272.009136806, 6060377.629259341, 6057103.585504688, 6054329.1223873915, 6051182.653754042, 6048523.258621891, 6046367.508511582, 6044256.322398064, 6042236.896054202, 6040210.074929925, 6038230.706869752, 6035308.318321127, 6032453.083393174, 6029527.078576496, 6026477.612747291, 6023333.99328134, 6020618.167479434, 6017972.835948429, 6015401.991223537, 6012788.337274603, 6010335.466450195])])
valid: OrderedDict([('l2', [53124293.895417936, 53022060.778796695, 52916970.39798651, 52820566.57335308, 52723548.23416552, 52597448.480167106, 52474681.21732355, 52352617.98722755, 52245101.57632615, 52129230.9240378, 52023135.87841521, 51917833.1159649, 51815161.19147513, 51715006.97474483, 51612061.16505968, 51523314.018073216, 51435243.49774776, 51345727.12881613, 51260941.50583827, 51176375.095062844, 51107741.384508, 51040312.30394841, 50968500.73790903, 50900197.575841054, 50824648.773127824, 50736287.4169774, 50649375.24475019, 50563886.517726734, 50479795.97710573, 50402632.20553151, 50340239.01572228, 50275293.26475293, 50211442.098349065, 50153252.55405822, 50092042.55679953, 50028526.68266696, 49961819.62769496, 49900324.10356763, 49837306.07205098, 49780129.30071595, 49727393.60027293, 49675944.80714634, 49625009.27819131, 49575693.15201122, 49526488.59041471, 49467939.841432944, 49405636.68905121, 49353375.304297246, 49296635.55277811, 49242205.71446729, 49190861.25493708, 49138196.18117475, 49085222.4631424, 49038385.6762817, 48989384.31025925, 48945483.900033146, 48898437.421678066, 48855754.69905732, 48812125.36593301, 48765558.84232551, 48713072.87102874, 48662020.64059363, 48615941.628205135, 48570942.77094148, 48526244.3427065, 48501977.153162025, 48477524.82452827, 48454249.09580631, 48430549.17965573, 48408230.475090034, 48365012.69041467, 48323276.362952106, 48279376.05424808, 48236818.08039121, 48199046.037304215, 48160673.987502724, 48121529.19679745, 48084296.9222826, 48049037.03444613, 48014345.42824394, 47967241.67167476, 47923497.844211906, 47877719.66952568, 47835250.22566369, 47793419.42524596, 47764668.102124035, 47736004.32851524, 47707315.54506275, 47687713.2009239, 47660974.21633419, 47646476.18963799, 47637741.8018214, 47623544.81474975, 47609150.38641171, 47596438.02026322, 47578265.32694816, 47560148.787984, 47542668.17489816, 47524040.2185081, 47506039.66709259, 47483887.83806557, 47462125.86736156, 47436251.66142085, 47420218.45564431, 47395091.81498682, 47367412.46269838, 47340180.78642089, 47316961.810914755, 47296696.01227124, 47274231.20041176, 47256607.682471775, 47228979.30426187, 47201965.965104766, 47175186.613103904, 47155863.832989246, 47137339.2385566, 47117091.06765872, 47099212.36890569, 47079708.22118166, 47062453.38234073, 47037503.09237373, 47012034.85095188, 46983678.62916284, 46959033.56697159, 46933750.0165754, 46919680.425958514, 46903239.95870393, 46889724.73699801, 46873864.38730325, 46860881.933863446, 46837253.051102936, 46822476.54194205, 46807991.232032664, 46792205.279926, 46766651.211495675, 46750516.396643415, 46737034.657743685, 46721397.27687776, 46706913.667956576, 46691321.76845811, 46692535.9532145, 46688202.07328276, 46684183.3105728, 46680046.618732065, 46676207.896392345, 46666740.95167922, 46657922.46718879, 46652597.33481587, 46641018.363311894, 46630098.419399925, 46620161.4239055, 46610431.27042984, 46595128.26064121, 46586964.33848071, 46572094.04728405, 46570759.38276917, 46569566.56741385, 46569024.52372804, 46568101.68472351, 46560040.80369601, 46541022.8966153, 46522305.36046572, 46501768.987065695, 46483492.17143729, 46464317.03912168, 46456622.185413316, 46448697.8573482, 46440445.12329784, 46426338.86567241, 46411791.931085296, 46397302.22798937, 46383027.524727955, 46366900.54265579, 46352998.84823163, 46338493.65407463, 46327092.38370433, 46311241.91641263, 46300200.981600724, 46291710.73430463, 46281535.6225152, 46279700.19528474, 46277052.15072855, 46275375.57164437, 46267944.51291061, 46260654.860183105, 46262165.14551244, 46263772.6808724, 46264350.14889262, 46263811.34218626, 46261048.76980127, 46257137.663144484, 46250500.90735706, 46245948.72797763, 46239620.16739998, 46236256.65567602, 46199796.55588921, 46163794.98606446, 46131218.86588824, 46100134.7482434, 46068392.61609405, 46068072.00159528, 46067825.90058775, 46069451.31891621, 46071311.63582023, 46071268.179737344, 46066962.44336118, 46061127.700160235, 46056128.234846495, 46052903.863520674, 46047423.64358196, 46045461.39150838, 46043583.96146092, 46041789.21022151, 46040075.04125657, 46034028.84991751, 46022845.34899135, 46011849.47648498, 46000405.596140854, 45989780.76861004, 45979333.606324255, 45977919.64499198, 45976574.03609381, 45975295.01913832, 45970245.75772141, 45966188.16278336, 45964726.92442762, 45960128.563412994, 45958861.2800868, 45953854.58401826, 45948734.83676826, 45931404.94035249, 45911536.645040505, 45894681.92850264, 45874780.141768865, 45855654.65949728, 45850971.998374596, 45846313.5942531.923120454, 45840343.419358656, 45829875.82285455, 45823626.544884026, 45817438.286349006, 45811419.182604775, 45810513.41834333, 45809019.577130824, 45808207.120124795, 45804292.08334419, 45801069.130494416, 45790749.890854515, 45779022.247124635, 45768961.37417113, 45756894.16404399, 45747182.59054186, 45748936.21115002, 45750708.102640994, 45754796.40829019, 45756602.24260883, 45758423.879684806, 45751511.132975124, 45745504.52081496, 45738918.64613684, 45733225.68052937, 45726952.852141775, 45720462.392486624, 45713709.528140076, 45707494.33903133, 45700903.83888283, 45697651.08792945, 45692412.82739849, 45687262.60822135, 45681598.58721233, 45676020.495194376, 45670526.8909507, 45664572.35275679, 45658850.520147905, 45653070.40396308, 45642782.44050284, 45637321.13421098, 45633594.08638325, 45629964.42355744, 45626104.21441003, 45621472.364029445, 45618960.31897076, 45620898.50153509, 45622190.50202845, 45629320.39288475, 45629277.32285416, 45633070.44991227, 45631124.98187689, 45630369.32107925, 45626963.660245664, 45625833.45577489, 45623965.19312585, 45629099.17679633, 45634228.26440023, 45627031.60891801, 45625550.73765092, 45622325.190536104, 45624277.81954939, 45625789.71696421, 45627323.7032944, 45628878.81991843, 45631714.87340535, 45635148.84802165, 45640599.873068176, 45644879.06576441, 45645017.56177193, 45650749.9860497, 45654695.82515711, 45653537.55367043, 45657402.20407036, 45649600.62309601, 45648610.30837333, 45648071.48732696, 45649397.769163884, 45649292.21580488, 45649821.030286446, 45647686.555893235, 45631352.229002096, 45613875.19596288, 45597985.70142003, 45582225.33664142, 45565793.64586818, 45565874.12310077, 45563846.830926135, 45563991.277315676, 45560538.31238348, 45558638.893116705, 45553290.0352007, 45550525.228195645, 45545241.89497183, 45539666.0857137, 45534217.24956667, 45544358.90336269, 45554430.89218618, 45564433.28317168, 45574366.15467119, 45584229.59531031, 45579119.79145297, 45576144.05348401, 45571056.37764144, 45568089.28881066, 45565173.54977028, 45564941.39253754, 45564839.34136824, 45564934.80761503, 45566771.79921117, 45567363.07782287, 45566099.46481009, 45564870.623567246, 45563675.76653422, 45562514.12221162, 45561384.93534218, 45561284.36808686, 45562558.54818293, 45562778.47274872, 45563735.44945454, 45569432.458395764, 45571284.14849865, 45573087.5219076, 45575300.910568714, 45577514.751453884, 45579348.21514136, 45587554.07546397, 45597103.921391614, 45605207.34249263, 45614651.59081997, 45622651.85667368, 45626255.059837215, 45628012.81689507, 45626695.94225818, 45623299.41784602, 45619961.26835548, 45617228.73466762, 45614558.427197024, 45612887.10288167, 45608133.50083964, 45606628.51006122, 45614049.84980221, 45621440.14367475, 45628964.61723953, 45631686.74934838, 45638461.171472006])])

Making predictions...

Sample predictions:
datetime    instrument
2024-01-01  ^NSEI_RAW_10YRS    13782.782514
2024-01-02  ^NSEI_RAW_10YRS    10147.815272
2024-01-03  ^NSEI_RAW_10YRS    11640.295060
2024-01-04  ^NSEI_RAW_10YRS    11017.923125
2024-01-05  ^NSEI_RAW_10YRS    11428.206914
dtype: float64
[17840:MainThread](2025-05-09 16:32:34,819) INFO - qlib.timer - [log.py:127] - Time cost: 1.840s | waiting `async_log` Done
[17840:MainThread](2025-05-09 16:32:34,819) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[ValueError: You can choose only one of `local_path`(save the files in a path) or `kwargs`(pass in the objects directly)].
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 489, in <module>
    main()
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 333, in main
    model_dir = save_model_with_config(exp_id, model, task)
  File "E:\Finance Internship\TASK_5\NSEI\model_raw.py", line 467, in save_model_with_config       
    R.save_objects(model_path, model=model)
  File "E:\Finance Internship\qlib_env\lib\site-packages\qlib\workflow\__init__.py", line 518, in save_objects
    raise ValueError(
ValueError: You can choose only one of `local_path`(save the files in a path) or `kwargs`(pass in the objects directly)